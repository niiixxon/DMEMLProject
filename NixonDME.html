<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>3d77ef162eea46f3b2f6d44f0c08ebee</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="73e30299" class="cell markdown"
data-slideshow="{&quot;slide_type&quot;:&quot;slide&quot;}">
<h1 id="predictions-of-credit-card-approval">Predictions of Credit Card
Approval</h1>
<h3 id="nixon-lobo">Nixon Lobo</h3>
<p>This project involves building a predictive model to assess the
credit risk of individuals applying for loans. The dataset contains
various features such as demographic information, financial data, and
credit history. The goal is to preprocess the data, perform exploratory
data analysis, engineer relevant features, and train multiple machine
learning models including Logistic Regression, Decision Trees, Random
Forest, and k-Nearest Neighbors (k-NN). These models are evaluated based
on metrics like accuracy, precision, recall, and F1 score. Additionally,
techniques like Weight of Evidence (WoE) transformation are employed for
feature engineering to enhance model performance. The final objective is
to select the best-performing model for predicting credit risk
effectively.</p>
</div>
<div id="8b7a2a51" class="cell markdown"
data-slideshow="{&quot;slide_type&quot;:&quot;slide&quot;}">
<p><img
src="https://i.pinimg.com/564x/1f/a8/82/1fa882891d98eb4d2c0888627618ba4e.jpg" /></p>
</div>
<div id="ac002465" class="cell markdown">
<p><strong>Importing Necessary Libraries</strong></p>
</div>
<div id="95b973d8f07b4c00" class="cell code" data-execution_count="1"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:15:52.968183Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:15:52.433909Z&quot;}">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">&#39;svg&#39;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd   </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#from imblearn.over_sampling import SMOTE</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, confusion_matrix</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score, precision_score, recall_score</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#from lightgbm import LGBMClassifier</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> catboost <span class="im">import</span> CatBoostClassifier</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> svm</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span></code></pre></div>
</div>
<div id="f5ed7ea548262c1b" class="cell markdown">
<p>Using Tensorflow Backend</p>
</div>
<div id="7b939f43aae1f802" class="cell code" data-execution_count="2"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:15:58.867559Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:15:58.344902Z&quot;}">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&quot;/Users/niiixxon/Desktop/Coursework/DME/archive/application_record.csv&quot;</span>, encoding <span class="op">=</span> <span class="st">&#39;utf-8&#39;</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>record <span class="op">=</span> pd.read_csv(<span class="st">&quot;/Users/niiixxon/Desktop/Coursework/DME/archive/credit_record.csv&quot;</span>, encoding <span class="op">=</span> <span class="st">&#39;utf-8&#39;</span>)  </span></code></pre></div>
</div>
<div id="44720350" class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>CODE_GENDER</th>
      <th>FLAG_OWN_CAR</th>
      <th>FLAG_OWN_REALTY</th>
      <th>CNT_CHILDREN</th>
      <th>AMT_INCOME_TOTAL</th>
      <th>NAME_INCOME_TYPE</th>
      <th>NAME_EDUCATION_TYPE</th>
      <th>NAME_FAMILY_STATUS</th>
      <th>NAME_HOUSING_TYPE</th>
      <th>DAYS_BIRTH</th>
      <th>DAYS_EMPLOYED</th>
      <th>FLAG_MOBIL</th>
      <th>FLAG_WORK_PHONE</th>
      <th>FLAG_PHONE</th>
      <th>FLAG_EMAIL</th>
      <th>OCCUPATION_TYPE</th>
      <th>CNT_FAM_MEMBERS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5008804</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>427500.0</td>
      <td>Working</td>
      <td>Higher education</td>
      <td>Civil marriage</td>
      <td>Rented apartment</td>
      <td>-12005</td>
      <td>-4542</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5008805</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>427500.0</td>
      <td>Working</td>
      <td>Higher education</td>
      <td>Civil marriage</td>
      <td>Rented apartment</td>
      <td>-12005</td>
      <td>-4542</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5008806</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>112500.0</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-21474</td>
      <td>-1134</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Security staff</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5008808</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>270000.0</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-19110</td>
      <td>-3051</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>Sales staff</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5008809</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>270000.0</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-19110</td>
      <td>-3051</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>Sales staff</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>438552</th>
      <td>6840104</td>
      <td>M</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>135000.0</td>
      <td>Pensioner</td>
      <td>Secondary / secondary special</td>
      <td>Separated</td>
      <td>House / apartment</td>
      <td>-22717</td>
      <td>365243</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>438553</th>
      <td>6840222</td>
      <td>F</td>
      <td>N</td>
      <td>N</td>
      <td>0</td>
      <td>103500.0</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-15939</td>
      <td>-3007</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Laborers</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>438554</th>
      <td>6841878</td>
      <td>F</td>
      <td>N</td>
      <td>N</td>
      <td>0</td>
      <td>54000.0</td>
      <td>Commercial associate</td>
      <td>Higher education</td>
      <td>Single / not married</td>
      <td>With parents</td>
      <td>-8169</td>
      <td>-372</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Sales staff</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>438555</th>
      <td>6842765</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>72000.0</td>
      <td>Pensioner</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-21673</td>
      <td>365243</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>438556</th>
      <td>6842885</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>121500.0</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-18858</td>
      <td>-1201</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Sales staff</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
<p>438557 rows × 18 columns</p>
</div>
</div>
</div>
<div id="b7b526fe" class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>record</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>MONTHS_BALANCE</th>
      <th>STATUS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5001711</td>
      <td>0</td>
      <td>X</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5001711</td>
      <td>-1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5001711</td>
      <td>-2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5001711</td>
      <td>-3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5001712</td>
      <td>0</td>
      <td>C</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1048570</th>
      <td>5150487</td>
      <td>-25</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1048571</th>
      <td>5150487</td>
      <td>-26</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1048572</th>
      <td>5150487</td>
      <td>-27</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1048573</th>
      <td>5150487</td>
      <td>-28</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1048574</th>
      <td>5150487</td>
      <td>-29</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
<p>1048575 rows × 3 columns</p>
</div>
</div>
</div>
<div id="ddf0eea7ffacf1f0" class="cell code" data-execution_count="5"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:16:04.449848Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:16:04.442898Z&quot;}">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">&#39;figure.facecolor&#39;</span>] <span class="op">=</span> <span class="st">&#39;white&#39;</span></span></code></pre></div>
</div>
<div id="a37da27212d14613" class="cell markdown">
<h2 id="feature-engineering">Feature Engineering</h2>
</div>
<div id="a5d4d5ceb752c5ca" class="cell markdown">
<p><em>Response Variable</em></p>
</div>
<div id="623dae17d5709c16" class="cell markdown">
<p>This code adds a new column called <code>begin_month</code> to the
<code>data</code> DataFrame, which represents the earliest month of
balance information for each ID as extracted from the
<code>record</code> DataFrame.</p>
</div>
<div id="a69110bf939a6763" class="cell code" data-execution_count="6"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:16:18.081227Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:16:17.947006Z&quot;}">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>begin_month<span class="op">=</span>pd.DataFrame(record.groupby([<span class="st">&quot;ID&quot;</span>])[<span class="st">&quot;MONTHS_BALANCE&quot;</span>].agg(<span class="bu">min</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>begin_month<span class="op">=</span>begin_month.rename(columns<span class="op">=</span>{<span class="st">&#39;MONTHS_BALANCE&#39;</span>:<span class="st">&#39;begin_month&#39;</span>}) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>new_data<span class="op">=</span>pd.merge(data,begin_month,how<span class="op">=</span><span class="st">&quot;left&quot;</span>,on<span class="op">=</span><span class="st">&quot;ID&quot;</span>) <span class="co">#merge to record data</span></span></code></pre></div>
</div>
<div id="32cc1de02ea88622" class="cell markdown">
<p><strong>Choosing users who overdue for more than 60 days as target
risk users. Those samples are marked 1 else 0</strong></p>
</div>
<div id="d47e9ac7746877f6" class="cell code" data-execution_count="7"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:07.661685Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:07.502960Z&quot;}">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column &#39;dep_value&#39; and initialize it with None</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>record[<span class="st">&#39;dep_value&#39;</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set &#39;dep_value&#39; to &#39;Yes&#39; where &#39;STATUS&#39; is &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, or &#39;5&#39;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>record[<span class="st">&#39;dep_value&#39;</span>] <span class="op">=</span> np.where((record[<span class="st">&#39;STATUS&#39;</span>] <span class="op">==</span> <span class="st">&#39;2&#39;</span>) <span class="op">|</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                               (record[<span class="st">&#39;STATUS&#39;</span>] <span class="op">==</span> <span class="st">&#39;3&#39;</span>) <span class="op">|</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                               (record[<span class="st">&#39;STATUS&#39;</span>] <span class="op">==</span> <span class="st">&#39;4&#39;</span>) <span class="op">|</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                               (record[<span class="st">&#39;STATUS&#39;</span>] <span class="op">==</span> <span class="st">&#39;5&#39;</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Yes&#39;</span>, record[<span class="st">&#39;dep_value&#39;</span>])</span></code></pre></div>
</div>
<div id="30d392058a68da84" class="cell code" data-execution_count="8"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:07.860383Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:07.685292Z&quot;}">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by &#39;ID&#39; and count the occurrences</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cpunt <span class="op">=</span> record.groupby(<span class="st">&#39;ID&#39;</span>).count()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set &#39;dep_value&#39; to &#39;Yes&#39; if count is greater than 0, otherwise &#39;No&#39;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>cpunt[<span class="st">&#39;dep_value&#39;</span>] <span class="op">=</span> np.where(cpunt[<span class="st">&#39;dep_value&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the &#39;dep_value&#39; column</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>cpunt <span class="op">=</span> cpunt[[<span class="st">&#39;dep_value&#39;</span>]]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge &#39;cpunt&#39; with &#39;new_data&#39; based on &#39;ID&#39;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> pd.merge(new_data, cpunt, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>, on<span class="op">=</span><span class="st">&#39;ID&#39;</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Map &#39;Yes&#39; to 1 and &#39;No&#39; to 0 in the &#39;target&#39; column</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;dep_value&#39;</span>].<span class="bu">map</span>({<span class="st">&#39;Yes&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;No&#39;</span>: <span class="dv">0</span>})</span></code></pre></div>
</div>
<div id="f070c83e61a93d87" class="cell code" data-execution_count="9"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:07.906853Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:07.885760Z&quot;}">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cpunt[<span class="st">&#39;dep_value&#39;</span>].value_counts())</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cpunt[<span class="st">&#39;dep_value&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>No     45318
Yes      667
Name: dep_value, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="9">
<pre><code>No     0.985495
Yes    0.014505
Name: dep_value, dtype: float64</code></pre>
</div>
</div>
<div id="d36659c6" class="cell markdown">
<p>These outputs represent the count and proportion of 'Yes' and 'No'
values in the 'dep_value' column:</p>
<ul>
<li>Count:
<ul>
<li>'No': 45,318 occurrences</li>
<li>'Yes': 667 occurrences</li>
</ul></li>
<li>Proportion:
<ul>
<li>'No': Approximately 98.55%</li>
<li>'Yes': Approximately 1.45%</li>
</ul></li>
</ul>
<p>These values indicate that the majority of the 'dep_value' column
contains 'No', with only a small proportion being 'Yes'.</p>
<hr />
</div>
<div id="32d66b32" class="cell markdown">
<p>This code renames columns in the <code>new_data</code></p>
</div>
<div id="3a34374a" class="cell code" data-execution_count="10"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:22.657108Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:22.625884Z&quot;}">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>new_data.rename(columns<span class="op">=</span>{<span class="st">&#39;CODE_GENDER&#39;</span>: <span class="st">&#39;Gender&#39;</span>, <span class="st">&#39;FLAG_OWN_CAR&#39;</span>: <span class="st">&#39;Car&#39;</span>, <span class="st">&#39;FLAG_OWN_REALTY&#39;</span>: <span class="st">&#39;Realty&#39;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;CNT_CHILDREN&#39;</span>: <span class="st">&#39;ChldNo&#39;</span>, <span class="st">&#39;AMT_INCOME_TOTAL&#39;</span>: <span class="st">&#39;inc&#39;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;NAME_EDUCATION_TYPE&#39;</span>: <span class="st">&#39;edutp&#39;</span>, <span class="st">&#39;NAME_FAMILY_STATUS&#39;</span>: <span class="st">&#39;famtp&#39;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;NAME_HOUSING_TYPE&#39;</span>: <span class="st">&#39;houtp&#39;</span>, <span class="st">&#39;FLAG_EMAIL&#39;</span>: <span class="st">&#39;email&#39;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;NAME_INCOME_TYPE&#39;</span>: <span class="st">&#39;inctp&#39;</span>, <span class="st">&#39;FLAG_WORK_PHONE&#39;</span>: <span class="st">&#39;wkphone&#39;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;FLAG_PHONE&#39;</span>: <span class="st">&#39;phone&#39;</span>, <span class="st">&#39;CNT_FAM_MEMBERS&#39;</span>: <span class="st">&#39;famsize&#39;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;OCCUPATION_TYPE&#39;</span>: <span class="st">&#39;occyp&#39;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                        }, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>new_data.dropna()</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> new_data.mask(new_data <span class="op">==</span> <span class="st">&#39;NULL&#39;</span>).dropna()</span></code></pre></div>
</div>
<div id="83245955dd1bda43" class="cell code" data-execution_count="11"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:21.466217Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:21.453987Z&quot;}">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an IV table DataFrame with column names from &#39;new_data&#39;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ivtable <span class="op">=</span> pd.DataFrame(new_data.columns, columns<span class="op">=</span>[<span class="st">&#39;variable&#39;</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the &#39;IV&#39; column with None</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ivtable[<span class="st">&#39;IV&#39;</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># List of columns to exclude</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>namelist <span class="op">=</span> [<span class="st">&#39;FLAG_MOBIL&#39;</span>, <span class="st">&#39;begin_month&#39;</span>, <span class="st">&#39;dep_value&#39;</span>, <span class="st">&#39;target&#39;</span>, <span class="st">&#39;ID&#39;</span>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove excluded columns from ivtable</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ivtable <span class="op">=</span> ivtable[<span class="op">~</span>ivtable[<span class="st">&#39;variable&#39;</span>].isin(namelist)]</span></code></pre></div>
</div>
<div id="dc9d670885021cba" class="cell markdown">
<p>Binary Features we will handle missing values, compute stats like
counts of occurances for each unique value, calculate additional metrics
such as share, bad rate, distribition among good and bad cases and
weight of evidence, IV for each value using WOE.</p>
</div>
<div id="7d8e829b9a6ac425" class="cell code" data-execution_count="12"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:18.375242Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:18.316119Z&quot;}">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_iv(df, feature, target, pr<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    lst <span class="op">=</span> []</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    df[feature] <span class="op">=</span> df[feature].fillna(<span class="st">&quot;NULL&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(df[feature].nunique()):</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        val <span class="op">=</span> <span class="bu">list</span>(df[feature].unique())[i]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        lst.append([feature,                                                        <span class="co"># Variable</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                    val,                                                            <span class="co"># Value</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                    df[df[feature] <span class="op">==</span> val].count()[feature],                        <span class="co"># All</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                    df[(df[feature] <span class="op">==</span> val) <span class="op">&amp;</span> (df[target] <span class="op">==</span> <span class="dv">0</span>)].count()[feature],  <span class="co"># Good (think: Fraud == 0)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                    df[(df[feature] <span class="op">==</span> val) <span class="op">&amp;</span> (df[target] <span class="op">==</span> <span class="dv">1</span>)].count()[feature]]) <span class="co"># Bad (think: Fraud == 1)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(lst, columns<span class="op">=</span>[<span class="st">&#39;Variable&#39;</span>, <span class="st">&#39;Value&#39;</span>, <span class="st">&#39;All&#39;</span>, <span class="st">&#39;Good&#39;</span>, <span class="st">&#39;Bad&#39;</span>])</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;Share&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;All&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;All&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;Bad Rate&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;Bad&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;All&#39;</span>]</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;Distribution Good&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;All&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;Bad&#39;</span>]) <span class="op">/</span> (data[<span class="st">&#39;All&#39;</span>].<span class="bu">sum</span>() <span class="op">-</span> data[<span class="st">&#39;Bad&#39;</span>].<span class="bu">sum</span>())</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;Distribution Bad&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;Bad&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;Bad&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;WoE&#39;</span>] <span class="op">=</span> np.log(data[<span class="st">&#39;Distribution Good&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;Distribution Bad&#39;</span>])</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.replace({<span class="st">&#39;WoE&#39;</span>: {np.inf: <span class="dv">0</span>, <span class="op">-</span>np.inf: <span class="dv">0</span>}})</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;IV&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;WoE&#39;</span>] <span class="op">*</span> (data[<span class="st">&#39;Distribution Good&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;Distribution Bad&#39;</span>])</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.sort_values(by<span class="op">=</span>[<span class="st">&#39;Variable&#39;</span>, <span class="st">&#39;Value&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">True</span>])</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    data.index <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(data.index))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pr:</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(data)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&#39;IV = &#39;</span>, data[<span class="st">&#39;IV&#39;</span>].<span class="bu">sum</span>())</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    iv <span class="op">=</span> data[<span class="st">&#39;IV&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;This variable</span><span class="ch">\&#39;</span><span class="st">s IV is:&#39;</span>,iv)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df[feature].value_counts())</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> iv, data</span></code></pre></div>
</div>
<div id="faab2c15" class="cell markdown">
<p><code>convert_dummy</code>, is designed to convert categorical
features into dummy variables in a pandas DataFrame.</p>
</div>
<div id="1ef408691c49e928" class="cell code" data-execution_count="13"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:27.841902Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:27.827403Z&quot;}">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dummy (df, feature, rank <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> pd.get_dummies(df[feature], prefix<span class="op">=</span>feature)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    mode <span class="op">=</span> df[feature].value_counts().index[rank]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    biggest <span class="op">=</span> feature <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span> <span class="bu">str</span>(mode)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    pos.drop([biggest], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    df.drop([feature], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>df.join(pos)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div>
</div>
<div id="f1ca2a95" class="cell markdown">
<p><code>get_category</code>, serves to divide a numerical column in a
DataFrame into categorical bins, either by equal frequency or equal
width.</p>
</div>
<div id="d55e5cf9b996ff33" class="cell code" data-execution_count="14"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:29.530866Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:29.526726Z&quot;}">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_category(df, col, binsum, labels, qcut <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> qcut:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        localdf <span class="op">=</span> pd.qcut(df[col], q <span class="op">=</span> binsum, labels<span class="op">=</span> labels) <span class="co"># Quantile Cut</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        localdf <span class="op">=</span> pd.cut(df[col], q <span class="op">=</span> binsum, labels<span class="op">=</span> labels) <span class="co"># Equal Lenght Cut</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    localdf <span class="op">=</span> pd.DataFrame(localdf)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">&#39;gp&#39;</span> <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span> col</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    localdf[name] <span class="op">=</span> localdf[col]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.join(localdf[name])</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    df[name] <span class="op">=</span> df[name].astype(<span class="bu">object</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div>
</div>
<div id="ce884e998f1527fb" class="cell markdown">
<p>if normalize is set to True, it normalizes the confusion matrix by
dividing each row by its sum.</p>
<p><code>plot_confusion_matrix</code> provides a clear visual
representation of the model's performance by illustrating the
distribution of predictions across different classes. It helps in
assessing the model's accuracy and identifying any patterns of
misclassification.</p>
</div>
<div id="c61f2a2809b523ce" class="cell code" data-execution_count="15"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:31.693818Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:31.682329Z&quot;}">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_confusion_matrix(cm, classes,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                          normalize<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                          title<span class="op">=</span><span class="st">&#39;Confusion matrix&#39;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                          cmap<span class="op">=</span>plt.cm.Blues):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalize:</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> cm.astype(<span class="st">&#39;float&#39;</span>) <span class="op">/</span> cm.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)[:, np.newaxis]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cm)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    plt.imshow(cm, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>, cmap<span class="op">=</span>cmap)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    plt.colorbar()</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    tick_marks <span class="op">=</span> np.arange(<span class="bu">len</span>(classes))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    plt.xticks(tick_marks, classes)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    plt.yticks(tick_marks, classes)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    fmt <span class="op">=</span> <span class="st">&#39;.2f&#39;</span> <span class="cf">if</span> normalize <span class="cf">else</span> <span class="st">&#39;d&#39;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> cm.<span class="bu">max</span>() <span class="op">/</span> <span class="fl">2.</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, j <span class="kw">in</span> itertools.product(<span class="bu">range</span>(cm.shape[<span class="dv">0</span>]), <span class="bu">range</span>(cm.shape[<span class="dv">1</span>])):</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        plt.text(j, i, <span class="bu">format</span>(cm[i, j], fmt),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                 horizontalalignment<span class="op">=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">&quot;white&quot;</span> <span class="cf">if</span> cm[i, j] <span class="op">&gt;</span> thresh <span class="cf">else</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;True label&#39;</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Predicted label&#39;</span>)</span></code></pre></div>
</div>
<div id="10609aa5f9b4bf64" class="cell markdown">
<h3 id="gender">Gender</h3>
<p>This code is used to transform the <strong>Gender</strong> column in
the <code>new_data</code> DataFrame from categorical values <em>('F' for
female and 'M' for male)</em> to numerical values <em>(0 for female and
1 for male)</em>.</p>
</div>
<div id="21364024e394d98c" class="cell code" data-execution_count="16"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-08T16:28:35.133076Z&quot;,&quot;start_time&quot;:&quot;2024-04-08T16:28:33.959879Z&quot;}">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;Gender&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;Gender&#39;</span>].replace([<span class="st">&#39;F&#39;</span>, <span class="st">&#39;M&#39;</span>], [<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;Gender&#39;</span>].value_counts())</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>iv, data <span class="op">=</span> calc_iv(new_data, <span class="st">&#39;Gender&#39;</span>, <span class="st">&#39;target&#39;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;Gender&#39;</span>, <span class="st">&#39;IV&#39;</span>] <span class="op">=</span> iv</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0    15630
1     9504
Name: Gender, dtype: int64
This variable&#39;s IV is: 0.02520350452745081
0    15630
1     9504
Name: Gender, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="16">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gender</td>
      <td>0</td>
      <td>15630</td>
      <td>15400</td>
      <td>230</td>
      <td>0.621867</td>
      <td>0.014715</td>
      <td>0.623179</td>
      <td>0.545024</td>
      <td>0.134005</td>
      <td>0.010473</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gender</td>
      <td>1</td>
      <td>9504</td>
      <td>9312</td>
      <td>192</td>
      <td>0.378133</td>
      <td>0.020202</td>
      <td>0.376821</td>
      <td>0.454976</td>
      <td>-0.188475</td>
      <td>0.014730</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="bf1faf4d" class="cell markdown">
<p><strong>Gender Value Counts:</strong></p>
<ul>
<li>The <em>Gender</em> column now contains two numerical values: 0 and
1, which correspond to the transformed genders.</li>
<li>The counts show that there are 15,630 entries with the value 0
(Female) and 9,504 entries with the value 1 (Male).</li>
</ul>
<p><strong>IV Calculation:</strong></p>
<ul>
<li>The IV calculated for the <em>Gender</em> variable is approximately
0.0252. This value indicates the predictive power of the <em>Gender</em>
variable regarding the target variable.</li>
<li>The output table above shows detailed statistics for each gender
value (0 and 1), including counts, proportions, bad rates, distributions
of good and bad outcomes, Weight of Evidence (WoE), and IV.</li>
<li>For example, the first row corresponds to gender value 0, indicating
that out of 15,630 entries with this value, 230 are considered 'Bad,'
resulting in a Bad Rate of approximately 0.0147.</li>
<li>A higher IV indicates stronger predictive power of the variable.
Typically, IV values above 0.02 are considered to have predictive
power.</li>
</ul>
<hr />
</div>
<div id="b48ef55b2336cce2" class="cell markdown">
<h3 id="having-a-car">Having a Car</h3>
<p>This code is used to transform the <em>Car</em> column in the
<code>new_data</code> DataFrame from categorical values <em>('Y' for yes
and 'N' for no)</em> to numerical values <em>(1 for yes and 0 for
no)</em>.</p>
</div>
<div id="1607ba936af3b06a" class="cell code" data-execution_count="17"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:10.469324Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:10.421735Z&quot;}">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;Car&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;Car&#39;</span>].replace([<span class="st">&#39;N&#39;</span>,<span class="st">&#39;Y&#39;</span>],[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;Car&#39;</span>].value_counts())</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;Car&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;Car&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0    14618
1    10516
Name: Car, dtype: int64
This variable&#39;s IV is: 4.54248124999671e-06
0    14618
1    10516
Name: Car, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="17">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Car</td>
      <td>0</td>
      <td>14618</td>
      <td>14373</td>
      <td>245</td>
      <td>0.581603</td>
      <td>0.016760</td>
      <td>0.58162</td>
      <td>0.580569</td>
      <td>0.00181</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Car</td>
      <td>1</td>
      <td>10516</td>
      <td>10339</td>
      <td>177</td>
      <td>0.418397</td>
      <td>0.016831</td>
      <td>0.41838</td>
      <td>0.419431</td>
      <td>-0.00251</td>
      <td>0.000003</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="34fe86cf" class="cell markdown">
<p><strong>Car Value Counts:</strong></p>
<p>The <em>Car</em> column has been transformed into numerical values,
where 0 represents <em>"not having a car"</em> and 1 represents
<em>"having a car."</em> The counts reveal that there are 14,618 entries
with the value 0 (not having a car) and 10,516 entries with the value 1
(having a car).</p>
<p><strong>IV Calculation:</strong></p>
<p>The Information Value (IV) calculated for the 'Car' variable is
approximately 4.54e-06. A higher IV indicates stronger predictive
power.</p>
<p><strong>Detailed Statistics:</strong></p>
<p>The first row corresponds to the value 0, indicating that out of
14,618 entries with this value, 245 are considered 'Bad,' resulting in a
Bad Rate of approximately 0.0168. Similarly, for the value 1, out of
10,516 entries, 177 are considered 'Bad,' with a Bad Rate of
approximately 0.0168.</p>
<hr />
</div>
<div id="75da1be4865a3b74" class="cell markdown">
<h3 id="having-a-house-or-not">Having a House or Not</h3>
<p>This code is used to transform the <em>Realty</em> column in the
<code>new_data</code> DataFrame from categorical values <em>('Y' for yes
and 'N' for no)</em> to numerical values <em>(1 for yes and 0 for
no)</em>.</p>
</div>
<div id="e653cd28d77c280f" class="cell code" data-execution_count="18"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:10.862536Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:10.822467Z&quot;}">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;Realty&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;Realty&#39;</span>].replace([<span class="st">&#39;N&#39;</span>,<span class="st">&#39;Y&#39;</span>],[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;Realty&#39;</span>].value_counts())</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;Realty&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;Realty&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1    16461
0     8673
Name: Realty, dtype: int64
This variable&#39;s IV is: 0.02744070350168343
1    16461
0     8673
Name: Realty, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="18">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Realty</td>
      <td>0</td>
      <td>8673</td>
      <td>8494</td>
      <td>179</td>
      <td>0.34507</td>
      <td>0.020639</td>
      <td>0.34372</td>
      <td>0.424171</td>
      <td>-0.210309</td>
      <td>0.016920</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Realty</td>
      <td>1</td>
      <td>16461</td>
      <td>16218</td>
      <td>243</td>
      <td>0.65493</td>
      <td>0.014762</td>
      <td>0.65628</td>
      <td>0.575829</td>
      <td>0.130777</td>
      <td>0.010521</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="cf768186" class="cell markdown">
<p><strong>Realty Value Counts:</strong></p>
<p>The <em>Realty</em> column has been transformed into numerical
values, where 0 represents "not owning real estate" and 1 represents
"owning real estate." The counts reveal that there are 30,148 entries
with the value 1 (owning real estate) and 1,986 entries with the value 0
(not owning real estate).</p>
<p><strong>IV Calculation:</strong></p>
<p>The Information Value (IV) calculated for the 'Realty' variable is
approximately 0.0044. A higher IV indicates stronger predictive
power.</p>
<p><strong>Detailed Statistics:</strong></p>
<p>The first row corresponds to the value 0, indicating that out of
1,986 entries with this value, 61 are considered 'Bad,' resulting in a
Bad Rate of approximately 0.0307. Similarly, for the value 1, out of
30,148 entries, 356 are considered 'Bad,' with a Bad Rate of
approximately 0.0147.</p>
<hr />
</div>
<div id="40430f43c860e7b7" class="cell markdown">
<h3 id="having-a-phone-or-not">Having a Phone or Not</h3>
<p>This code is used to transform the <em>Phone</em> column in the
<code>new_data</code> DataFrame from categorical values <em>('Y' for yes
and 'N' for no)</em> to numerical values <em>(1 for yes and 0 for
no)</em>.</p>
</div>
<div id="ae9de282b04bcfbc" class="cell code" data-execution_count="19"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:11.285711Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:11.227751Z&quot;}">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;phone&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;phone&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;phone&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>,sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>new_data.drop(new_data[new_data[<span class="st">&#39;phone&#39;</span>] <span class="op">==</span> <span class="st">&#39;nan&#39;</span> ].index, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;phone&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;phone&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0    0.707209
1    0.292791
Name: phone, dtype: float64
This variable&#39;s IV is: 0.0005480495762639297
0    17775
1     7359
Name: phone, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="19">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>phone</td>
      <td>0</td>
      <td>17775</td>
      <td>17481</td>
      <td>294</td>
      <td>0.707209</td>
      <td>0.016540</td>
      <td>0.707389</td>
      <td>0.696682</td>
      <td>0.015251</td>
      <td>0.000163</td>
    </tr>
    <tr>
      <th>1</th>
      <td>phone</td>
      <td>1</td>
      <td>7359</td>
      <td>7231</td>
      <td>128</td>
      <td>0.292791</td>
      <td>0.017394</td>
      <td>0.292611</td>
      <td>0.303318</td>
      <td>-0.035937</td>
      <td>0.000385</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="5d7e8e66" class="cell markdown">
<p><strong>Phone Counts :</strong></p>
<p>The <em>Phone</em> column contains string values, including numerical
values and 'nan' (presumably representing missing values). After
converting the column to string type, the value counts normalize the
frequencies. It reveals that there are approximately 99.5% of entries
with phone numbers and around 0.5% with missing phone numbers
('nan').</p>
<p><strong>IV Calculation:</strong></p>
<p>The Information Value (IV) calculated for the <em>Phone</em> variable
is approximately 5.268e-05. A higher IV indicates stronger predictive
power.</p>
<p><strong>Detailed Statistics:</strong></p>
<p>The output table provides detailed statistics for each value of the
<em>Phone</em> variable (excluding 'nan'). The first row corresponds to
the value '0', indicating that out of approximately 41,005 entries with
this value, 578 are considered 'Bad,' resulting in a Bad Rate of
approximately 0.0141.</p>
<hr />
</div>
<div id="89237f205f41d5d6" class="cell markdown">
<h3 id="having-an-email-or-not">Having an Email or not</h3>
<p>This code is used to transform the <em>email</em> column in the
<code>new_data</code> DataFrame from categorical values <em>('Y' for yes
and 'N' for no)</em> to numerical values <em>(1 for yes and 0 for
no)</em>.</p>
</div>
<div id="ed84c503b861da61" class="cell code" data-execution_count="20"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:11.709077Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:11.650972Z&quot;}">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;email&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>,sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;email&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;email&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;email&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;email&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0    0.89934
1    0.10066
Name: email, dtype: float64
This variable&#39;s IV is: 1.7343581493999816e-05
0    22604
1     2530
Name: email, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="20">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>email</td>
      <td>0</td>
      <td>22604</td>
      <td>22225</td>
      <td>379</td>
      <td>0.89934</td>
      <td>0.016767</td>
      <td>0.899361</td>
      <td>0.898104</td>
      <td>0.001398</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>email</td>
      <td>1</td>
      <td>2530</td>
      <td>2487</td>
      <td>43</td>
      <td>0.10066</td>
      <td>0.016996</td>
      <td>0.100639</td>
      <td>0.101896</td>
      <td>-0.012407</td>
      <td>0.000016</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="00592470" class="cell markdown">
<p><strong>Email Counts:</strong></p>
<p>The <em>Email</em> column contains string values, including numerical
values and 'nan' (presumably representing missing values). After
converting the column to string type, the value counts normalize the
frequencies. It reveals that there are approximately 99.8% of entries
without email addresses and around 0.2% with email addresses.</p>
<p><strong>IV Calculation:</strong></p>
<p>The Information Value (IV) calculated for the 'Email' variable is
approximately 1.151e-05. IV is a measure of the predictive power of the
variable concerning the target variable. A higher IV indicates stronger
predictive power.</p>
<p><strong>Detailed Statistics:</strong></p>
<p>The output table provides detailed statistics for each value of the
'Email' variable (excluding 'nan').</p>
<p>The first row corresponds to the value '0', indicating that out of
approximately 53,792 entries without email addresses, 676 are considered
'Bad,' resulting in a Bad Rate of approximately 0.0169.</p>
<hr />
</div>
<div id="2bf715370f889f7c" class="cell markdown">
<h3 id="having-a-work-phone-or-not">Having a Work Phone or Not</h3>
<p>This code is used to transform the <em>wkphone</em> column in the
<code>new_data</code> DataFrame from categorical values <em>('Y' for yes
and 'N' for no)</em> to numerical values <em>(1 for yes and 0 for
no)</em>.</p>
</div>
<div id="bd8e7467ac927b36" class="cell code" data-execution_count="21"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:12.128531Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:12.065425Z&quot;}">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;wkphone&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;wkphone&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>iv, data <span class="op">=</span> calc_iv(new_data,<span class="st">&#39;wkphone&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>new_data.drop(new_data[new_data[<span class="st">&#39;wkphone&#39;</span>] <span class="op">==</span> <span class="st">&#39;nan&#39;</span> ].index, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;wkphone&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.002042429795148461
0    18252
1     6882
Name: wkphone, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="21">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>wkphone</td>
      <td>0</td>
      <td>18252</td>
      <td>17954</td>
      <td>298</td>
      <td>0.726188</td>
      <td>0.016327</td>
      <td>0.72653</td>
      <td>0.706161</td>
      <td>0.028436</td>
      <td>0.000579</td>
    </tr>
    <tr>
      <th>1</th>
      <td>wkphone</td>
      <td>1</td>
      <td>6882</td>
      <td>6758</td>
      <td>124</td>
      <td>0.273812</td>
      <td>0.018018</td>
      <td>0.27347</td>
      <td>0.293839</td>
      <td>-0.071838</td>
      <td>0.001463</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="ca044916" class="cell markdown">
<p><strong>Value Counts for 'Work Phone':</strong></p>
<p>The 'Work Phone' column contains string values, including numerical
values and 'nan' (presumably representing missing values). After
converting the column to string type, the value counts normalize the
frequencies. It reveals that there are approximately 6.9% of entries
with work phone numbers and around 93.1% without work phone numbers.</p>
<p><strong>IV Calculation:</strong></p>
<p>The Information Value (IV) calculated for the 'Work Phone' variable
is approximately 5.14e-07. IV is a measure of the predictive power of
the variable concerning the target variable. A higher IV indicates
stronger predictive power.</p>
<p><strong>Detailed Statistics:</strong></p>
<p>The output table provides detailed statistics for each value of the
'Work Phone' variable (excluding 'nan').</p>
<p>For instance, the first row corresponds to the value '0', indicating
that out of approximately 57,000 entries without work phone numbers, 761
are considered 'Bad,' resulting in a Bad Rate of approximately
0.0180.</p>
<hr />
</div>
<div id="dd194de8" class="cell markdown">
<p>This code block converts specific columns in the
<code>new_data</code> DataFrame to string type if needed, calculates the
Information Value (IV) for categorical variables ('email', 'houtp',
'phone'), and updates the IV table accordingly. Entries with 'nan'
values in these columns are dropped to ensure accurate calculations.</p>
</div>
<div id="2f65b4503dbb7efa" class="cell code" data-execution_count="22"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:12.463969Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:12.266940Z&quot;}">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert columns to string type if needed</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;email&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;email&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;houtp&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;houtp&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;phone&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;phone&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IV and update ivtable for &#39;email&#39;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>iv_email, data_email <span class="op">=</span> calc_iv(new_data, <span class="st">&#39;email&#39;</span>, <span class="st">&#39;target&#39;</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>new_data.drop(new_data[new_data[<span class="st">&#39;email&#39;</span>] <span class="op">==</span> <span class="st">&#39;nan&#39;</span>].index, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>] <span class="op">==</span> <span class="st">&#39;email&#39;</span>, <span class="st">&#39;IV&#39;</span>] <span class="op">=</span> iv_email</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IV and update ivtable for &#39;houtp&#39; (house)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>iv_houtp, data_houtp <span class="op">=</span> calc_iv(new_data, <span class="st">&#39;houtp&#39;</span>, <span class="st">&#39;target&#39;</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>new_data.drop(new_data[new_data[<span class="st">&#39;houtp&#39;</span>] <span class="op">==</span> <span class="st">&#39;nan&#39;</span>].index, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>] <span class="op">==</span> <span class="st">&#39;houtp&#39;</span>, <span class="st">&#39;IV&#39;</span>] <span class="op">=</span> iv_houtp</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IV and update ivtable for &#39;phone&#39;</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>iv_phone, data_phone <span class="op">=</span> calc_iv(new_data, <span class="st">&#39;phone&#39;</span>, <span class="st">&#39;target&#39;</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>new_data.drop(new_data[new_data[<span class="st">&#39;phone&#39;</span>] <span class="op">==</span> <span class="st">&#39;nan&#39;</span>].index, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>] <span class="op">==</span> <span class="st">&#39;phone&#39;</span>, <span class="st">&#39;IV&#39;</span>] <span class="op">=</span> iv_phone</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 1.7343581493999816e-05
0    22604
1     2530
Name: email, dtype: int64
This variable&#39;s IV is: 0.0073275026880227365
House / apartment      22102
With parents            1430
Municipal apartment      812
Rented apartment         439
Office apartment         199
Co-op apartment          152
Name: houtp, dtype: int64
This variable&#39;s IV is: 0.0005480495762639297
0    17775
1     7359
Name: phone, dtype: int64
</code></pre>
</div>
</div>
<div id="06e18bbe" class="cell markdown">
<p>For the 'email' variable:</p>
<ul>
<li>IV: 1.734e-05</li>
<li>Counts: 22,604 entries with value 0 and 2,530 entries with value
1.</li>
</ul>
<p>For the 'houtp' (house type) variable:</p>
<ul>
<li>IV: 0.00733</li>
<li>Counts:
<ul>
<li>House/apartment: 22,102</li>
<li>With parents: 1,430</li>
<li>Municipal apartment: 812</li>
<li>Rented apartment: 439</li>
<li>Office apartment: 199</li>
<li>Co-op apartment: 152</li>
</ul></li>
</ul>
<p>For the 'phone' variable:</p>
<ul>
<li>IV: 0.000548</li>
<li>Counts: 17,775 entries with value 0 and 7,359 entries with value
1.</li>
</ul>
<hr />
</div>
<div id="c341b40c0ca0ef16" class="cell markdown">
<h1 id="continuous-variables">Continuous Variables</h1>
</div>
<div id="34ccc96b607fb464" class="cell markdown">
<h3 id="number-of-children">Number of Children</h3>
<p>This code modifies the values in the <em>ChldNo</em> column of the
DataFrame <code>new_data</code>.</p>
<p>It first locates rows where the value in the <em>ChldNo</em> column
is greater than or equal to 2. For these rows, it replaces the original
value with the string <code>2More</code>.</p>
<p>Afterward, it prints the value counts of the <em>ChldNo</em> column,
displaying the distribution of the modified values.</p>
</div>
<div id="6051469bf2df8735" class="cell code" data-execution_count="23"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:13.370858Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:13.349058Z&quot;}">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>new_data.loc[new_data[<span class="st">&#39;ChldNo&#39;</span>] <span class="op">&gt;=</span> <span class="dv">2</span>,<span class="st">&#39;ChldNo&#39;</span>]<span class="op">=</span><span class="st">&#39;2More&#39;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;ChldNo&#39;</span>].value_counts(sort<span class="op">=</span><span class="va">False</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0        15908
2More     3108
1         6118
Name: ChldNo, dtype: int64
</code></pre>
</div>
</div>
<div id="d19474c0f2237d02" class="cell code" data-execution_count="24"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:13.803759Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:13.742017Z&quot;}">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;ChldNo&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;ChldNo&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.0011214542503301935
0        15908
1         6118
2More     3108
Name: ChldNo, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="24">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ChldNo</td>
      <td>0</td>
      <td>15908</td>
      <td>15635</td>
      <td>273</td>
      <td>0.632928</td>
      <td>0.017161</td>
      <td>0.632689</td>
      <td>0.646919</td>
      <td>-0.022243</td>
      <td>0.000317</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ChldNo</td>
      <td>1</td>
      <td>6118</td>
      <td>6021</td>
      <td>97</td>
      <td>0.243415</td>
      <td>0.015855</td>
      <td>0.243647</td>
      <td>0.229858</td>
      <td>0.058259</td>
      <td>0.000803</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ChldNo</td>
      <td>2More</td>
      <td>3108</td>
      <td>3056</td>
      <td>52</td>
      <td>0.123657</td>
      <td>0.016731</td>
      <td>0.123665</td>
      <td>0.123223</td>
      <td>0.003580</td>
      <td>0.000002</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="48e84d3c" class="cell markdown">
<p>The "Number of Children" variable has been processed as follows:</p>
<ul>
<li>The calculated Information Value (IV) for this variable is
approximately 0.00112.</li>
<li>The variable has three categories: 0, 1, and "2More", representing
the number of children.</li>
<li>The counts for each category are as follows:
<ul>
<li>Category 0: 15,908 entries</li>
<li>Category 1: 6,118 entries</li>
<li>Category "2More": 3,108 entries</li>
</ul></li>
<li>Each category contributes differently to the predictive power of the
variable, as indicated by their respective IV values.</li>
</ul>
</div>
<div id="769ab55cb74261db" class="cell code" data-execution_count="25"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:14.293186Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:14.279532Z&quot;}">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;ChldNo&#39;</span>)</span></code></pre></div>
</div>
<div id="8b6caf7ab5f3eec0" class="cell markdown">
<h3 id="annual-income">Annual Income</h3>
<p>This code converts the <em>inc</em> column in the DataFrame
<code>new_data</code> to object type and then divides the values by
10,000, effectively converting the income values to units of 10,000.</p>
<p>It then prints the value counts of the <em>inc</em> column, grouped
into 10 bins, showing the distribution of the income values.</p>
<p>Finally, it creates a histogram plot of the <em>inc</em> column with
50 bins and density normalization, providing a visual representation of
the income distribution.</p>
</div>
<div id="b7abcb8ae211b91f" class="cell code" data-execution_count="26"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:15.271581Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:15.043590Z&quot;}">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;inc&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;inc&#39;</span>].astype(<span class="bu">object</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;inc&#39;</span>] <span class="op">=</span> new_data[<span class="st">&#39;inc&#39;</span>]<span class="op">/</span><span class="dv">10000</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;inc&#39;</span>].value_counts(bins<span class="op">=</span><span class="dv">10</span>,sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;inc&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>,bins<span class="op">=</span><span class="dv">50</span>,density<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(2.544, 18.18]      14663
(18.18, 33.66]       8464
(33.66, 49.14]       1637
(49.14, 64.62]        175
(64.62, 80.1]         124
(80.1, 95.58]          50
(95.58, 111.06]         4
(111.06, 126.54]        3
(126.54, 142.02]        6
(142.02, 157.5]         8
Name: inc, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="26">
<pre><code>&lt;Axes: ylabel=&#39;Frequency&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/2a746251517378949792826cad110cdcb922c959.svg" /></p>
</div>
</div>
<div id="7ab6eba2" class="cell markdown">
<p>The histogram shows the distribution of annual income values in the
dataset after converting them to units of 10,000.</p>
<ul>
<li>The x-axis represents income ranges, each labeled with the upper
limit of the range.</li>
<li>The y-axis represents the frequency or count of individuals falling
within each income range.</li>
</ul>
<p>From the histogram:</p>
<ul>
<li>The majority of individuals (14,663) have an annual income between
2.544 and 18.18 units of 10,000.</li>
<li>The distribution shows a decreasing trend as income ranges increase,
with fewer individuals having higher incomes.</li>
<li>There are only a few individuals with very high incomes, as
indicated by the lower frequencies in the higher income
<code>ranges.new_data['inc'].dtype</code></li>
</ul>
<hr />
</div>
<div id="f5a747f2" class="cell markdown">
<p>This code attempts to convert the <em>inc</em> column in the
<em>new_data</em> DataFrame to numeric data type. The parameter
<code>errors='coerce</code> is used to handle any non-numeric values by
converting them to NaN <em>(Not a Number)</em>. This ensures that all
values in the <em>inc</em> column are numeric, facilitating further
analysis and calculations involving income.</p>
</div>
<div id="c9db4f4625b796a5" class="cell code" data-execution_count="27"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:16.001500Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:15.994990Z&quot;}">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;inc&#39;</span>] <span class="op">=</span> pd.to_numeric(new_data[<span class="st">&#39;inc&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span></code></pre></div>
</div>
<div id="4bb0b2ac8b08d98f" class="cell code" data-execution_count="28"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:16.364514Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:16.285541Z&quot;}">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> get_category(new_data,<span class="st">&#39;inc&#39;</span>, <span class="dv">3</span>, [<span class="st">&quot;low&quot;</span>,<span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>], qcut <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>iv, data <span class="op">=</span> calc_iv(new_data,<span class="st">&#39;gp_inc&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;inc&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.0024219962221596752
low       8996
high      8244
medium    7894
Name: gp_inc, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="28">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gp_inc</td>
      <td>high</td>
      <td>8244</td>
      <td>8096</td>
      <td>148</td>
      <td>0.328002</td>
      <td>0.017952</td>
      <td>0.327614</td>
      <td>0.350711</td>
      <td>-0.068126</td>
      <td>0.001573</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gp_inc</td>
      <td>low</td>
      <td>8996</td>
      <td>8849</td>
      <td>147</td>
      <td>0.357922</td>
      <td>0.016341</td>
      <td>0.358085</td>
      <td>0.348341</td>
      <td>0.027588</td>
      <td>0.000269</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gp_inc</td>
      <td>medium</td>
      <td>7894</td>
      <td>7767</td>
      <td>127</td>
      <td>0.314077</td>
      <td>0.016088</td>
      <td>0.314301</td>
      <td>0.300948</td>
      <td>0.043413</td>
      <td>0.000580</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="95f47ac6" class="cell markdown">
<p>The code segments above perform the following operations:</p>
<ol>
<li><p><strong>Binning of Income ('inc') Column</strong>: The 'inc'
column in the <code>new_data</code> DataFrame is divided into three
categories ('low', 'medium', 'high') based on equal frequency binning
using the 'get_category' function.</p></li>
<li><p><strong>Information Value (IV) Calculation</strong>: The IV for
the binned income categories (<code>gp_inc</code>) is calculated using
the <code>calc_iv</code> function. IV quantifies the predictive power of
a variable in relation to the target variable.</p></li>
<li><p><strong>Updating IV Table</strong>: The IV value calculated for
the 'inc' variable is updated in the <code>ivtable</code> DataFrame
under the corresponding variable name.</p></li>
<li><p><strong>Output Summary</strong>: The output provides the IV value
and counts for each income category ('low', 'medium', 'high'), along
with other statistical measures such as Share, Bad Rate, Distribution
Good, Distribution Bad, Weight of Evidence (WoE), and IV for each
category. These measures help assess the predictive strength of income
categories in predicting the target variable.</p></li>
</ol>
</div>
<div id="12bdf4b3528b0580" class="cell code" data-execution_count="29"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:16.579885Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:16.564657Z&quot;}"
data-scrolled="true">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;gp_inc&#39;</span>)</span></code></pre></div>
</div>
<div id="26c15c2a8369e29b" class="cell markdown">
<h3 id="age">Age</h3>
<p>The code segments perform the following operations:</p>
<ol>
<li><p><strong>Calculating Age</strong>: The age of individuals is
calculated using the 'DAYS_BIRTH' column, which represents the number of
days since birth. The negative sign is used to convert the days to
years, and then the values are divided by 365 to obtain age in
years.</p></li>
<li><p><strong>Binning Age</strong>: The age values are divided into 10
bins using the <code>value_counts</code> method with the parameter
<code>bins=10</code>. The <code>normalize=True</code> parameter is used
to compute the proportion of values in each bin relative to the total
count.</p></li>
<li><p><strong>Plotting Histogram</strong>: A histogram of age
distribution is plotted using the <code>plot</code> method with
<code>kind='hist</code> and <code>bins=20</code> to visualize the
distribution of ages. The <code>density=True</code> parameter normalizes
the histogram to represent a probability density function.</p></li>
</ol>
</div>
<div id="56df80f5fcc3f9cc" class="cell code" data-execution_count="30"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:42.620252Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:42.529828Z&quot;}">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;Age&#39;</span>]<span class="op">=-</span>(new_data[<span class="st">&#39;DAYS_BIRTH&#39;</span>])<span class="op">//</span><span class="dv">365</span>	</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;Age&#39;</span>].value_counts(bins<span class="op">=</span><span class="dv">10</span>,normalize<span class="op">=</span><span class="va">True</span>,sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;Age&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>,bins<span class="op">=</span><span class="dv">20</span>,density<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(19.951999999999998, 24.7]    0.025066
(24.7, 29.4]                  0.134280
(29.4, 34.1]                  0.169770
(34.1, 38.8]                  0.140805
(38.8, 43.5]                  0.173072
(43.5, 48.2]                  0.141880
(48.2, 52.9]                  0.099069
(52.9, 57.6]                  0.076550
(57.6, 62.3]                  0.032585
(62.3, 67.0]                  0.006923
Name: Age, dtype: float64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="30">
<pre><code>&lt;Axes: ylabel=&#39;Frequency&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/755382d52fdcededfe5f2fa86b17ec56384dfa86.svg" /></p>
</div>
</div>
<div id="237646ac" class="cell markdown">
<p>The output displays the proportion of individuals falling into each
age group, which are represented as bins. Each bin represents a range of
ages. Here's a breakdown:</p>
<ul>
<li><strong>Age Bins</strong>: The age values are grouped into 10 bins,
each covering a specific range of ages.</li>
<li><strong>Proportions</strong>: The values indicate the proportion of
individuals within each age bin relative to the total count. For
example, approximately 13.4% of individuals fall within the age range of
24.7 to 29.4 years.</li>
<li><h2
id="histogram-the-histogram-visualizes-the-distribution-of-ages-where-each-bar-represents-an-age-bin-and-the-height-of-the-bar-corresponds-to-the-proportion-of-individuals-in-that-age-group"><strong>Histogram</strong>:
The histogram visualizes the distribution of ages, where each bar
represents an age bin, and the height of the bar corresponds to the
proportion of individuals in that age group.</h2></li>
</ul>
</div>
<div id="5afb8f25" class="cell markdown">
<p>This function, <code>get_category</code>, categorizes a numerical
column in a DataFrame into bins based on specified criteria and assigns
labels to each bin. Here's a breakdown of its parameters and
functionality:</p>
<ul>
<li><strong>Functionality</strong>:
<ul>
<li>The function categorizes the values in the specified column
(<code>col</code>) into bins based on the specified criteria
(<code>binsnum</code>) and assigns labels (<code>labels</code>) to each
bin.</li>
<li>If <code>qcut</code> is <code>True</code>, it performs quantile cut
using <code>pd.qcut</code>, dividing the data into <code>binsnum</code>
quantiles.</li>
<li>If <code>qcut</code> is <code>False</code>, it performs equal-length
cut using <code>pd.cut</code>, dividing the data into
<code>binsnum</code> bins of equal width.</li>
<li>It creates a new DataFrame (<code>localdf</code>) containing the
categorized column and joins it back to the original DataFrame
(<code>df</code>) using the common index.</li>
<li>Finally, it returns the modified DataFrame (<code>df</code>) with
the categorized column added.</li>
</ul></li>
</ul>
<p>This function is useful for discretizing numerical data into
categories, which can be helpful for certain types of analysis and
modeling tasks.</p>
</div>
<div id="95bd8483ab935c55" class="cell code" data-execution_count="31"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:43.878346Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:43.858385Z&quot;}">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_category(df, col, binsnum, labels, qcut<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> qcut:</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        localdf <span class="op">=</span> pd.qcut(df[col], q<span class="op">=</span>binsnum, labels<span class="op">=</span>labels)  <span class="co"># Quantile Cut</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        localdf <span class="op">=</span> pd.cut(df[col], bins<span class="op">=</span>binsnum, labels<span class="op">=</span>labels)  <span class="co"># Equal Length Cut</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    localdf <span class="op">=</span> pd.DataFrame(localdf)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">&#39;gp_&#39;</span> <span class="op">+</span> col</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    localdf[name] <span class="op">=</span> localdf[col].astype(<span class="bu">object</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.join(localdf[name])</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div>
</div>
<div id="fc0284c403e67205" class="cell code" data-execution_count="32"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:44.931908Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:44.849074Z&quot;}">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> get_category(new_data,<span class="st">&#39;Age&#39;</span>,<span class="dv">5</span>, [<span class="st">&quot;lowest&quot;</span>,<span class="st">&quot;low&quot;</span>,<span class="st">&quot;medium&quot;</span>,<span class="st">&quot;high&quot;</span>,<span class="st">&quot;highest&quot;</span>])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>iv, data <span class="op">=</span> calc_iv(new_data,<span class="st">&#39;gp_Age&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;DAYS_BIRTH&#39;</span>,<span class="st">&#39;IV&#39;</span>] <span class="op">=</span> iv</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.06593513858884348
medium     7916
low        7806
high       4414
lowest     4005
highest     993
Name: gp_Age, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="32">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gp_Age</td>
      <td>high</td>
      <td>4414</td>
      <td>4323</td>
      <td>91</td>
      <td>0.175619</td>
      <td>0.020616</td>
      <td>0.174935</td>
      <td>0.215640</td>
      <td>-0.209194</td>
      <td>0.008515</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gp_Age</td>
      <td>highest</td>
      <td>993</td>
      <td>989</td>
      <td>4</td>
      <td>0.039508</td>
      <td>0.004028</td>
      <td>0.040021</td>
      <td>0.009479</td>
      <td>1.440361</td>
      <td>0.043992</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gp_Age</td>
      <td>low</td>
      <td>7806</td>
      <td>7686</td>
      <td>120</td>
      <td>0.310575</td>
      <td>0.015373</td>
      <td>0.311023</td>
      <td>0.284360</td>
      <td>0.089625</td>
      <td>0.002390</td>
    </tr>
    <tr>
      <th>3</th>
      <td>gp_Age</td>
      <td>lowest</td>
      <td>4005</td>
      <td>3921</td>
      <td>84</td>
      <td>0.159346</td>
      <td>0.020974</td>
      <td>0.158668</td>
      <td>0.199052</td>
      <td>-0.226754</td>
      <td>0.009157</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gp_Age</td>
      <td>medium</td>
      <td>7916</td>
      <td>7793</td>
      <td>123</td>
      <td>0.314952</td>
      <td>0.015538</td>
      <td>0.315353</td>
      <td>0.291469</td>
      <td>0.078758</td>
      <td>0.001881</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="b0471a77" class="cell markdown">
<p>This code first categorizes the 'Age' column in the DataFrame
<code>new_data</code> into five groups: 'lowest', 'low', 'medium',
'high', and 'highest'. Then, it calculates the Information Value (IV)
for the grouped 'Age' variable with respect to the target variable.
Finally, it updates the IV value in the <code>ivtable</code> DataFrame
for the variable 'DAYS_BIRTH' (which is the original 'Age' column).</p>
<p>The resulting IV for the grouped 'Age' variable is approximately
0.0659, indicating a moderate predictive power regarding the target
variable. The grouped 'Age' variable is then displayed along with its
corresponding counts.</p>
</div>
<div id="7645855b03913882" class="cell code" data-execution_count="33"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:45.786920Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:45.771514Z&quot;}">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;gp_Age&#39;</span>)</span></code></pre></div>
</div>
<div id="7f8d81fee1e95f1" class="cell markdown">
<h3 id="working-years">Working Years</h3>
<ul>
<li>Equal Lenght Bucketing</li>
</ul>
<p>This code snippet performs the following tasks:</p>
<ol>
<li>Calculates the working years from the 'DAYS_EMPLOYED' column and
assigns it to a new column named 'worktm'.</li>
<li>Replaces negative working years (if any) with NaN (Not a
Number).</li>
<li>Fills the NaN values in the 'worktm' column with the mean value of
working years.</li>
<li>Plots a histogram of the 'worktm' column to visualize the
distribution of working years.</li>
</ol>
<p>The histogram provides insights into the distribution of working
years among the individuals in the dataset. Adjust the number of bins in
the histogram (<code>bins=20</code> in this example) according to the
desired level of granularity in the visualization.</p>
</div>
<div id="f3f650e318766f48" class="cell code" data-execution_count="34"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:47.890856Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:47.748920Z&quot;}">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;worktm&#39;</span>] <span class="op">=</span> <span class="op">-</span>(new_data[<span class="st">&#39;DAYS_EMPLOYED&#39;</span>]) <span class="op">//</span> <span class="dv">365</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>worktm_bins <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Working Years Distribution (Normalized):&quot;</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;worktm&#39;</span>].value_counts(bins<span class="op">=</span>worktm_bins, normalize<span class="op">=</span><span class="va">True</span>, sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Histogram of Working Years:&quot;</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;worktm&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, bins<span class="op">=</span><span class="dv">20</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Working Years&#39;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Density&#39;</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Working Years Distribution (Normalized):
(-0.044, 2.15]    0.281054
(2.15, 4.3]       0.195512
(4.3, 6.45]       0.135235
(6.45, 8.6]       0.114466
(8.6, 10.75]      0.078141
(10.75, 12.9]     0.047426
(12.9, 15.05]     0.056060
(15.05, 17.2]     0.016790
(17.2, 19.35]     0.018819
(19.35, 21.5]     0.015119
(21.5, 23.65]     0.011896
(23.65, 25.8]     0.008992
(25.8, 27.95]     0.006127
(27.95, 30.1]     0.005331
(30.1, 32.25]     0.003263
(32.25, 34.4]     0.002188
(34.4, 36.55]     0.001711
(36.55, 38.7]     0.000597
(38.7, 40.85]     0.001074
(40.85, 43.0]     0.000199
Name: worktm, dtype: float64
Histogram of Working Years:
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/e8c1cb2f698b4890a6b8b954c510a96332da28e9.svg" /></p>
</div>
</div>
<div id="c9c32c7d" class="cell markdown">
<p>The "Working Years Distribution (Normalized)" provides a breakdown of
the distribution of working years among the individuals in the dataset.
Each bin represents a range of working years, and the values are
normalized to show the proportion of individuals falling into each
bin.</p>
<p>For example, the first bin "(-0.044, 2.15]" indicates that
approximately 28.1% of individuals have worked between 0 and 2.15 years.
Similarly, the second bin "(2.15, 4.3]" represents about 19.6% of
individuals who have worked between 2.15 and 4.3 years, and so on.</p>
<p>The "Histogram of Working Years" visualizes this distribution using a
histogram, where each bar represents a bin from the distribution. The
density parameter is set to True, indicating that the histogram is
normalized to show the density instead of raw counts. This provides a
visual representation of the distribution of working years among the
individuals in the dataset.</p>
</div>
<div id="7150580915a217ea" class="cell code" data-execution_count="35"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:48.625012Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:48.547204Z&quot;}">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> get_category(new_data,<span class="st">&#39;worktm&#39;</span>,<span class="dv">5</span>, [<span class="st">&quot;lowest&quot;</span>,<span class="st">&quot;low&quot;</span>,<span class="st">&quot;medium&quot;</span>,<span class="st">&quot;high&quot;</span>,<span class="st">&quot;highest&quot;</span>])</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;gp_worktm&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;DAYS_EMPLOYED&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.04022152230816303
lowest     18254
low         4987
medium      1378
high         425
highest       90
Name: gp_worktm, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="35">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gp_worktm</td>
      <td>high</td>
      <td>425</td>
      <td>423</td>
      <td>2</td>
      <td>0.016909</td>
      <td>0.004706</td>
      <td>0.017117</td>
      <td>0.004739</td>
      <td>1.284186</td>
      <td>0.015895</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gp_worktm</td>
      <td>highest</td>
      <td>90</td>
      <td>90</td>
      <td>0</td>
      <td>0.003581</td>
      <td>0.000000</td>
      <td>0.003642</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gp_worktm</td>
      <td>low</td>
      <td>4987</td>
      <td>4921</td>
      <td>66</td>
      <td>0.198416</td>
      <td>0.013234</td>
      <td>0.199134</td>
      <td>0.156398</td>
      <td>0.241573</td>
      <td>0.010324</td>
    </tr>
    <tr>
      <th>3</th>
      <td>gp_worktm</td>
      <td>lowest</td>
      <td>18254</td>
      <td>17916</td>
      <td>338</td>
      <td>0.726267</td>
      <td>0.018516</td>
      <td>0.724992</td>
      <td>0.800948</td>
      <td>-0.099635</td>
      <td>0.007568</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gp_worktm</td>
      <td>medium</td>
      <td>1378</td>
      <td>1362</td>
      <td>16</td>
      <td>0.054826</td>
      <td>0.011611</td>
      <td>0.055115</td>
      <td>0.037915</td>
      <td>0.374082</td>
      <td>0.006434</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="1ab53f17" class="cell markdown">
<p>This output displays the results of binning the 'worktm' (working
years) column into five categories labeled as 'lowest,' 'low,' 'medium,'
'high,' and 'highest.' The IV (Information Value) for this variable is
approximately 0.0402, indicating a moderate predictive power regarding
the target variable.</p>
<p>Each row in the table corresponds to a category of working years,
showing statistics such as the count of observations ('All'), the count
of good outcomes ('Good'), the count of bad outcomes ('Bad'), the share
of observations, the bad rate, the distribution of good outcomes, the
distribution of bad outcomes, the Weight of Evidence (WoE), and the IV
for each category.</p>
<p>For example, the first row represents the 'high' category, indicating
that out of 425 observations in this category, 423 are classified as
'Good' and 2 as 'Bad.' The WoE is 1.284, indicating a positive
relationship with the target variable. The IV for this category is
0.0159.</p>
<p>Similarly, the 'highest' category has 90 observations, all classified
as 'Good,' resulting in an IV of 0. The 'low' category has the highest
count of observations (4,987), with a WoE of 0.2416 and an IV of
0.0103.</p>
<p>These results provide insights into the relationship between working
years and the target variable, allowing for informed decision-making in
predictive modeling.</p>
<hr />
</div>
<div id="6ce3512ec9d394cc" class="cell code" data-execution_count="36"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:49.192693Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:49.177001Z&quot;}">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;gp_worktm&#39;</span>)</span></code></pre></div>
</div>
<div id="71c86a5fb65ad39d" class="cell markdown">
<h3 id="family-size">Family Size</h3>
<p>This code will display the counts of unique values in the 'famsize'
column, without sorting the results.</p>
</div>
<div id="7dfc536b8d88f468" class="cell code" data-execution_count="37"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:50.256132Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:50.240349Z&quot;}">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;famsize&#39;</span>].value_counts(sort<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<pre><code>2.0     12697
1.0      4263
5.0       307
3.0      5216
4.0      2576
6.0        51
15.0        3
7.0        18
20.0        1
9.0         2
Name: famsize, dtype: int64</code></pre>
</div>
</div>
<div id="c1f4d6c9dfb99267" class="cell code" data-execution_count="38"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:50.801403Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:50.732697Z&quot;}">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;famsize&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;famsize&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;famsizegp&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;famsize&#39;</span>]</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;famsizegp&#39;</span>]<span class="op">=</span>new_data[<span class="st">&#39;famsizegp&#39;</span>].astype(<span class="bu">object</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>new_data.loc[new_data[<span class="st">&#39;famsizegp&#39;</span>]<span class="op">&gt;=</span><span class="dv">3</span>,<span class="st">&#39;famsizegp&#39;</span>]<span class="op">=</span><span class="st">&#39;3more&#39;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;famsizegp&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;famsize&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.006156138510778323
2        12697
3more     8174
1         4263
Name: famsizegp, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="38">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>famsizegp</td>
      <td>1</td>
      <td>4263</td>
      <td>4179</td>
      <td>84</td>
      <td>0.169611</td>
      <td>0.019704</td>
      <td>0.169108</td>
      <td>0.199052</td>
      <td>-0.163028</td>
      <td>0.004882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>famsizegp</td>
      <td>2</td>
      <td>12697</td>
      <td>12489</td>
      <td>208</td>
      <td>0.505172</td>
      <td>0.016382</td>
      <td>0.505382</td>
      <td>0.492891</td>
      <td>0.025027</td>
      <td>0.000313</td>
    </tr>
    <tr>
      <th>2</th>
      <td>famsizegp</td>
      <td>3more</td>
      <td>8174</td>
      <td>8044</td>
      <td>130</td>
      <td>0.325217</td>
      <td>0.015904</td>
      <td>0.325510</td>
      <td>0.308057</td>
      <td>0.055108</td>
      <td>0.000962</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="72ea2a34" class="cell markdown">
<h3 id="family-sizes">Family Sizes</h3>
<p>The provided code segment transforms the 'famsize' column into
categorical groups based on the number of family members. It then
calculates the Information Value (IV) to assess the predictive power of
this variable in relation to the target variable.</p>
<h4 id="steps">Steps:</h4>
<ol>
<li><p><strong>Convert to Integer Type:</strong> The 'famsize' column is
converted to integer type to ensure consistency in data type.</p></li>
<li><p><strong>Create a New Column:</strong> A new column named
'famsizegp' is created to store the categorized family sizes.</p></li>
<li><p><strong>Convert to Object Type:</strong> The 'famsizegp' column
is converted to object type in preparation for categorical
grouping.</p></li>
<li><p><strong>Categorize Family Sizes:</strong> Family sizes equal to
or greater than 3 are categorized as '3more'.</p></li>
<li><p><strong>Calculate IV:</strong> The Information Value (IV) is
calculated for the 'famsizegp' variable using the 'calc_iv' function,
which assesses its predictive power in relation to the target
variable.</p></li>
<li><p><strong>Update IV Table:</strong> The calculated IV value is then
updated in the IV table (ivtable) for future reference.</p></li>
</ol>
<h4 id="results">Results:</h4>
<p>The resulting table displays the IV calculation for each family size
category, along with other statistics such as counts, proportions, bad
rates, and Weight of Evidence (WoE).</p>
</div>
<div id="3e28c15eb3095568" class="cell code" data-execution_count="39"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:51.398414Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:51.381304Z&quot;}">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;famsizegp&#39;</span>)</span></code></pre></div>
</div>
<div id="6a7972550470e904" class="cell code" data-execution_count="40"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:51.933012Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:51.919571Z&quot;}">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>new_data</span></code></pre></div>
<div class="output execute_result" data-execution_count="40">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Gender</th>
      <th>Car</th>
      <th>Realty</th>
      <th>inc</th>
      <th>inctp</th>
      <th>edutp</th>
      <th>famtp</th>
      <th>houtp</th>
      <th>DAYS_BIRTH</th>
      <th>...</th>
      <th>gp_Age_highest</th>
      <th>gp_Age_low</th>
      <th>gp_Age_lowest</th>
      <th>worktm</th>
      <th>gp_worktm_high</th>
      <th>gp_worktm_highest</th>
      <th>gp_worktm_low</th>
      <th>gp_worktm_medium</th>
      <th>famsizegp_1</th>
      <th>famsizegp_3more</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>5008806</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>11.25</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-21474</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5008808</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>27.00</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-19110</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5008809</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>27.00</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-19110</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5008810</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>27.00</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-19110</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5008811</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>27.00</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>House / apartment</td>
      <td>-19110</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36452</th>
      <td>5149828</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>31.50</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-17348</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36453</th>
      <td>5149834</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>15.75</td>
      <td>Commercial associate</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-12387</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36454</th>
      <td>5149838</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>15.75</td>
      <td>Pensioner</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-12387</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36455</th>
      <td>5150049</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>28.35</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-17958</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36456</th>
      <td>5150337</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11.25</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Single / not married</td>
      <td>Rented apartment</td>
      <td>-9188</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25134 rows × 36 columns</p>
</div>
</div>
</div>
<div id="7fd4f50aa8179fc2" class="cell markdown">
<h1 id="categorical-features">Categorical Features</h1>
</div>
<div id="f59bde7301087b6b" class="cell markdown">
<h3 id="income-type"><strong>Income Type</strong></h3>
<p>This code segment categorizes income types, normalizes their counts,
combines similar types, calculates the IV for predictive power, and
updates the IV table accordingly.</p>
</div>
<div id="c09ce31f8dd40b9c" class="cell code"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:53.595236Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:53.531903Z&quot;}">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;inctp&#39;</span>].value_counts(sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;inctp&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>,sort<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>new_data.loc[new_data[<span class="st">&#39;inctp&#39;</span>]<span class="op">==</span><span class="st">&#39;Pensioner&#39;</span>,<span class="st">&#39;inctp&#39;</span>]<span class="op">=</span><span class="st">&#39;State servant&#39;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>new_data.loc[new_data[<span class="st">&#39;inctp&#39;</span>]<span class="op">==</span><span class="st">&#39;Student&#39;</span>,<span class="st">&#39;inctp&#39;</span>]<span class="op">=</span><span class="st">&#39;State servant&#39;</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;inctp&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;inctp&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
</div>
<div id="ba0cb46d" class="cell markdown">
<p>The output displays the distribution of individuals based on their
income type. It shows the count of individuals in each income category,
with the majority being classified as "Working" (15,622 individuals),
followed by "Commercial associate" (7,052 individuals) and "State
servant" (2,437 individuals). However, there are very few individuals
categorized as "Student" (10 individuals) and "Pensioner" (13
individuals).</p>
<p>The normalized counts provide the proportion of each income type
relative to the total number of individuals. This allows for a clearer
comparison of the distribution of income types.</p>
<p>After merging similar income types ("Student" and "Pensioner" into
"State servant"), the code calculates the Information Value (IV) for the
predictive power of income type regarding the target variable. The IV
quantifies the strength of the relationship between the income type and
the target variable. In this case, the IV is relatively low, indicating
a weak predictive power of income type alone for the target
variable.</p>
</div>
<div id="9c3e230b11d1dc67" class="cell code"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:54.075564Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:54.060911Z&quot;}">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;inctp&#39;</span>)</span></code></pre></div>
</div>
<div id="6b71d20ce38fc15c" class="cell markdown">
<h3 id="occupation-type"><strong>Occupation Type</strong></h3>
<p>The code snippet provided categorizes occupations into broader
categories: "Laborwk" for labor-related occupations, "officewk" for
office-related occupations, and "hightecwk" for high-tech-related
occupations. After grouping the occupations, it calculates the
Information Value (IV) to assess the predictive power of occupation
types on the target variable.</p>
</div>
<div id="50a625b747c2fd35" class="cell code" data-execution_count="41"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:55.212502Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:55.149570Z&quot;}">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>new_data.loc[(new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Cleaning staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Cooking staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Drivers&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Laborers&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Low-skill Laborers&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Security staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Waiters/barmen staff&#39;</span>),<span class="st">&#39;occyp&#39;</span>]<span class="op">=</span><span class="st">&#39;Laborwk&#39;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>new_data.loc[(new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Accountants&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Core staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;HR staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Medicine staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Private service staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Realty agents&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Sales staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Secretaries&#39;</span>),<span class="st">&#39;occyp&#39;</span>]<span class="op">=</span><span class="st">&#39;officewk&#39;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>new_data.loc[(new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;Managers&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;High skill tech staff&#39;</span>) <span class="op">|</span> (new_data[<span class="st">&#39;occyp&#39;</span>]<span class="op">==</span><span class="st">&#39;IT staff&#39;</span>),<span class="st">&#39;occyp&#39;</span>]<span class="op">=</span><span class="st">&#39;hightecwk&#39;</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data[<span class="st">&#39;occyp&#39;</span>].value_counts())</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;occyp&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;occyp&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>data.head()   </span></code></pre></div>
<div class="output stream stdout">
<pre><code>Laborwk      10496
officewk     10183
hightecwk     4455
Name: occyp, dtype: int64
This variable&#39;s IV is: 0.004820472062853304
Laborwk      10496
officewk     10183
hightecwk     4455
Name: occyp, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="41">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>occyp</td>
      <td>Laborwk</td>
      <td>10496</td>
      <td>10311</td>
      <td>185</td>
      <td>0.417602</td>
      <td>0.017626</td>
      <td>0.417247</td>
      <td>0.438389</td>
      <td>-0.049428</td>
      <td>0.001045</td>
    </tr>
    <tr>
      <th>1</th>
      <td>occyp</td>
      <td>hightecwk</td>
      <td>4455</td>
      <td>4375</td>
      <td>80</td>
      <td>0.177250</td>
      <td>0.017957</td>
      <td>0.177039</td>
      <td>0.189573</td>
      <td>-0.068404</td>
      <td>0.000857</td>
    </tr>
    <tr>
      <th>2</th>
      <td>occyp</td>
      <td>officewk</td>
      <td>10183</td>
      <td>10026</td>
      <td>157</td>
      <td>0.405148</td>
      <td>0.015418</td>
      <td>0.405714</td>
      <td>0.372038</td>
      <td>0.086652</td>
      <td>0.002918</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="d10c111b" class="cell markdown">
<p>The occupation variable has been grouped into three categories:
"Laborwk" for labor-related occupations, "officewk" for office-related
occupations, and "hightecwk" for high-tech-related occupations.</p>
<p>The count of individuals in each category after the grouping is
displayed. Additionally, the Information Value (IV) has been calculated
to assess the predictive power of the occupation variable regarding the
target variable.</p>
<p>The output table presents detailed statistics for each occupation
category, including counts, proportions, bad rates, distributions of
good and bad outcomes, Weight of Evidence (WoE), and IV.</p>
<p>For example, in the "Laborwk" category, out of 10,496 individuals,
185 are classified as "Bad," resulting in a Bad Rate of approximately
0.0176. The WoE for this category is approximately -0.0494, indicating a
negative association with the target variable. The IV for this category
is 0.0010, suggesting a moderate predictive power. Similarly, statistics
are provided for the other occupation categories.</p>
</div>
<div id="c8416579950f74b4" class="cell code" data-execution_count="42"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:55.731599Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:55.717521Z&quot;}">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;occyp&#39;</span>)</span></code></pre></div>
</div>
<div id="adefb9be02251f6a" class="cell markdown">
<h3 id="house-type"><strong>House Type</strong></h3>
<p>This code calculates the Information Value (IV) for the "houtp"
variable and updates the IV table accordingly.</p>
</div>
<div id="1f533b183ad27231" class="cell code" data-execution_count="43"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:56.646220Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:56.579876Z&quot;}"
data-scrolled="true">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;houtp&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;houtp&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.0073275026880227365
House / apartment      22102
With parents            1430
Municipal apartment      812
Rented apartment         439
Office apartment         199
Co-op apartment          152
Name: houtp, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="43">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>houtp</td>
      <td>Co-op apartment</td>
      <td>152</td>
      <td>149</td>
      <td>3</td>
      <td>0.006048</td>
      <td>0.019737</td>
      <td>0.006029</td>
      <td>0.007109</td>
      <td>-0.164705</td>
      <td>0.000178</td>
    </tr>
    <tr>
      <th>1</th>
      <td>houtp</td>
      <td>House / apartment</td>
      <td>22102</td>
      <td>21738</td>
      <td>364</td>
      <td>0.879367</td>
      <td>0.016469</td>
      <td>0.879654</td>
      <td>0.862559</td>
      <td>0.019624</td>
      <td>0.000335</td>
    </tr>
    <tr>
      <th>2</th>
      <td>houtp</td>
      <td>Municipal apartment</td>
      <td>812</td>
      <td>793</td>
      <td>19</td>
      <td>0.032307</td>
      <td>0.023399</td>
      <td>0.032090</td>
      <td>0.045024</td>
      <td>-0.338655</td>
      <td>0.004380</td>
    </tr>
    <tr>
      <th>3</th>
      <td>houtp</td>
      <td>Office apartment</td>
      <td>199</td>
      <td>194</td>
      <td>5</td>
      <td>0.007918</td>
      <td>0.025126</td>
      <td>0.007850</td>
      <td>0.011848</td>
      <td>-0.411619</td>
      <td>0.001646</td>
    </tr>
    <tr>
      <th>4</th>
      <td>houtp</td>
      <td>Rented apartment</td>
      <td>439</td>
      <td>433</td>
      <td>6</td>
      <td>0.017466</td>
      <td>0.013667</td>
      <td>0.017522</td>
      <td>0.014218</td>
      <td>0.208939</td>
      <td>0.000690</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="04f250a2" class="cell markdown">
<p>This output presents the IV calculation results for the "houtp"
variable, which represents the type of housing. The IV calculated for
this variable is approximately 0.0073, indicating a moderate predictive
power.</p>
<p>The table provides detailed statistics for each category of housing
type, including counts, shares, bad rates, and WoE (Weight of Evidence).
WoE measures the strength and direction of the relationship between the
housing type and the target variable.</p>
<p>For example:</p>
<ul>
<li>"House / apartment" has the highest share at 87.94%, with a
relatively low bad rate of 1.65%.</li>
<li>"Municipal apartment" has a higher bad rate of 2.34% compared to the
average bad rate, resulting in a negative WoE (-0.339), suggesting it is
less likely associated with the target.</li>
<li>"Office apartment" has a relatively higher bad rate of 2.51% and a
negative WoE (-0.412), indicating it might be negatively correlated with
the target.</li>
<li>"Co-op apartment" has the lowest share at 0.61% and a negative WoE
(-0.165), suggesting it might have a slightly negative association with
the target.</li>
</ul>
<p>These insights help in understanding the predictive power and
potential impact of the housing type variable on the target
variable.</p>
</div>
<div id="97f82651d3fce245" class="cell code" data-execution_count="44"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:57.095125Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:57.059107Z&quot;}">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;houtp&#39;</span>)</span></code></pre></div>
</div>
<div id="64afff5ec7b3f61" class="cell markdown">
<h3 id="marriage-condition"><strong>Marriage Condition</strong></h3>
<p>This code computes the normalized value counts for the "famtp"
variable in the "new_data" DataFrame. It calculates the proportion of
each unique value in the "famtp" column relative to the total number of
values, providing insights into the distribution of different family
types in the dataset.</p>
</div>
<div id="69f98f53346abf0e" class="cell code" data-execution_count="45"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:57.931632Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:57.908343Z&quot;}">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>new_data[<span class="st">&#39;famtp&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>,sort<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<pre><code>Married                 0.696626
Single / not married    0.137065
Civil marriage          0.084865
Separated               0.058367
Widow                   0.023076
Name: famtp, dtype: float64</code></pre>
</div>
</div>
<div id="d4eda5e9" class="cell markdown">
<p>The output represents the distribution of different family types in
the dataset, with each type listed along with its corresponding
proportion or frequency.</p>
<ul>
<li>"Married" accounts for approximately 69.66% of the dataset,
indicating that it's the most common family type.</li>
<li>"Single / not married" represents around 13.71% of the dataset.</li>
<li>"Civil marriage" comprises about 8.49% of the dataset.</li>
<li>"Separated" accounts for approximately 5.84%.</li>
<li>"Widow" represents the smallest proportion at about 2.31%.</li>
</ul>
<p>These proportions are normalized, providing a relative comparison of
the frequencies of each family type within the dataset.</p>
<hr />
</div>
<div id="b101f9a371f1067" class="cell code" data-execution_count="46"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:58.378230Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:58.315576Z&quot;}">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;famtp&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;famtp&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.043137115423127946
Married                 17509
Single / not married     3445
Civil marriage           2133
Separated                1467
Widow                     580
Name: famtp, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="46">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>famtp</td>
      <td>Civil marriage</td>
      <td>2133</td>
      <td>2101</td>
      <td>32</td>
      <td>0.084865</td>
      <td>0.015002</td>
      <td>0.085019</td>
      <td>0.075829</td>
      <td>0.114394</td>
      <td>0.001051</td>
    </tr>
    <tr>
      <th>1</th>
      <td>famtp</td>
      <td>Married</td>
      <td>17509</td>
      <td>17232</td>
      <td>277</td>
      <td>0.696626</td>
      <td>0.015820</td>
      <td>0.697313</td>
      <td>0.656398</td>
      <td>0.060467</td>
      <td>0.002474</td>
    </tr>
    <tr>
      <th>2</th>
      <td>famtp</td>
      <td>Separated</td>
      <td>1467</td>
      <td>1452</td>
      <td>15</td>
      <td>0.058367</td>
      <td>0.010225</td>
      <td>0.058757</td>
      <td>0.035545</td>
      <td>0.502608</td>
      <td>0.011666</td>
    </tr>
    <tr>
      <th>3</th>
      <td>famtp</td>
      <td>Single / not married</td>
      <td>3445</td>
      <td>3362</td>
      <td>83</td>
      <td>0.137065</td>
      <td>0.024093</td>
      <td>0.136047</td>
      <td>0.196682</td>
      <td>-0.368588</td>
      <td>0.022349</td>
    </tr>
    <tr>
      <th>4</th>
      <td>famtp</td>
      <td>Widow</td>
      <td>580</td>
      <td>565</td>
      <td>15</td>
      <td>0.023076</td>
      <td>0.025862</td>
      <td>0.022863</td>
      <td>0.035545</td>
      <td>-0.441263</td>
      <td>0.005596</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="0f2e6c58" class="cell markdown">
<p>The output shows the Information Value (IV) calculation results for
the 'famtp' variable. The IV is approximately 0.0431, indicating
moderate predictive power.</p>
</div>
<div id="a76882cdf05f6675" class="cell code" data-execution_count="47"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:26:58.846441Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:26:58.810263Z&quot;}">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;famtp&#39;</span>)</span></code></pre></div>
</div>
<div id="91f99b8a24373fb2" class="cell markdown">
<h2 id="education">Education</h2>
</div>
<div id="aca28ea3a1099e29" class="cell code" data-execution_count="48"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:00.928764Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:00.871298Z&quot;}">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>new_data.loc[new_data[<span class="st">&#39;edutp&#39;</span>]<span class="op">==</span><span class="st">&#39;Academic degree&#39;</span>,<span class="st">&#39;edutp&#39;</span>]<span class="op">=</span><span class="st">&#39;Higher education&#39;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>iv, data<span class="op">=</span>calc_iv(new_data,<span class="st">&#39;edutp&#39;</span>,<span class="st">&#39;target&#39;</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;edutp&#39;</span>,<span class="st">&#39;IV&#39;</span>]<span class="op">=</span>iv</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>This variable&#39;s IV is: 0.010361794017679489
Secondary / secondary special    16808
Higher education                  7146
Incomplete higher                  993
Lower secondary                    187
Name: edutp, dtype: int64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="48">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Value</th>
      <th>All</th>
      <th>Good</th>
      <th>Bad</th>
      <th>Share</th>
      <th>Bad Rate</th>
      <th>Distribution Good</th>
      <th>Distribution Bad</th>
      <th>WoE</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>edutp</td>
      <td>Higher education</td>
      <td>7146</td>
      <td>7018</td>
      <td>128</td>
      <td>0.284316</td>
      <td>0.017912</td>
      <td>0.283992</td>
      <td>0.303318</td>
      <td>-0.065836</td>
      <td>0.001272</td>
    </tr>
    <tr>
      <th>1</th>
      <td>edutp</td>
      <td>Incomplete higher</td>
      <td>993</td>
      <td>972</td>
      <td>21</td>
      <td>0.039508</td>
      <td>0.021148</td>
      <td>0.039333</td>
      <td>0.049763</td>
      <td>-0.235206</td>
      <td>0.002453</td>
    </tr>
    <tr>
      <th>2</th>
      <td>edutp</td>
      <td>Lower secondary</td>
      <td>187</td>
      <td>181</td>
      <td>6</td>
      <td>0.007440</td>
      <td>0.032086</td>
      <td>0.007324</td>
      <td>0.014218</td>
      <td>-0.663301</td>
      <td>0.004573</td>
    </tr>
    <tr>
      <th>3</th>
      <td>edutp</td>
      <td>Secondary / secondary special</td>
      <td>16808</td>
      <td>16541</td>
      <td>267</td>
      <td>0.668736</td>
      <td>0.015885</td>
      <td>0.669351</td>
      <td>0.632701</td>
      <td>0.056310</td>
      <td>0.002064</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="57ae4dd192fc7fed" class="cell code" data-execution_count="49"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:01.709695Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:01.693413Z&quot;}">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> convert_dummy(new_data,<span class="st">&#39;edutp&#39;</span>)</span></code></pre></div>
</div>
<div id="b5063a1751230db" class="cell markdown">
<p><strong>The IV value measures the variable's ability to
predict.</strong></p>
</div>
<div id="94c250976693d00f" class="cell code" data-execution_count="50"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:04.599362Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:04.572353Z&quot;}">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>ivtable<span class="op">=</span>ivtable.sort_values(by<span class="op">=</span><span class="st">&#39;IV&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;DAYS_BIRTH&#39;</span>,<span class="st">&#39;variable&#39;</span>]<span class="op">=</span><span class="st">&#39;agegp&#39;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;DAYS_EMPLOYED&#39;</span>,<span class="st">&#39;variable&#39;</span>]<span class="op">=</span><span class="st">&#39;worktmgp&#39;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>ivtable.loc[ivtable[<span class="st">&#39;variable&#39;</span>]<span class="op">==</span><span class="st">&#39;inc&#39;</span>,<span class="st">&#39;variable&#39;</span>]<span class="op">=</span><span class="st">&#39;incgp&#39;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>ivtable</span></code></pre></div>
<div class="output execute_result" data-execution_count="50">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>IV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>agegp</td>
      <td>0.065935</td>
    </tr>
    <tr>
      <th>8</th>
      <td>famtp</td>
      <td>0.043137</td>
    </tr>
    <tr>
      <th>11</th>
      <td>worktmgp</td>
      <td>0.040222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Realty</td>
      <td>0.027441</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gender</td>
      <td>0.025204</td>
    </tr>
    <tr>
      <th>7</th>
      <td>edutp</td>
      <td>0.010362</td>
    </tr>
    <tr>
      <th>9</th>
      <td>houtp</td>
      <td>0.007328</td>
    </tr>
    <tr>
      <th>17</th>
      <td>famsize</td>
      <td>0.006156</td>
    </tr>
    <tr>
      <th>16</th>
      <td>occyp</td>
      <td>0.00482</td>
    </tr>
    <tr>
      <th>5</th>
      <td>incgp</td>
      <td>0.002422</td>
    </tr>
    <tr>
      <th>13</th>
      <td>wkphone</td>
      <td>0.002042</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ChldNo</td>
      <td>0.001121</td>
    </tr>
    <tr>
      <th>14</th>
      <td>phone</td>
      <td>0.000548</td>
    </tr>
    <tr>
      <th>15</th>
      <td>email</td>
      <td>0.000017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Car</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>6</th>
      <td>inctp</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="d5f931639a29f787" class="cell markdown">
<p>Higher IV values indicate stronger predictive power of the predictor
variable. IV values can be used to rank predictor variables based on
their importance in predicting the target variable.</p>
</div>
<div id="a661806fab56bd73" class="cell markdown">
<h2 id="algorithms">Algorithms</h2>
</div>
<div id="46df5fb60915d007" class="cell markdown">
<ul>
<li>Split Dataset</li>
</ul>
</div>
<div id="26b7fbfb5fe8ea3e" class="cell code" data-execution_count="51"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:08.437551Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:08.404683Z&quot;}">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>new_data.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="51">
<pre><code>Index([&#39;ID&#39;, &#39;Gender&#39;, &#39;Car&#39;, &#39;Realty&#39;, &#39;inc&#39;, &#39;inctp&#39;, &#39;DAYS_BIRTH&#39;,
       &#39;DAYS_EMPLOYED&#39;, &#39;FLAG_MOBIL&#39;, &#39;wkphone&#39;, &#39;phone&#39;, &#39;email&#39;, &#39;famsize&#39;,
       &#39;begin_month&#39;, &#39;dep_value&#39;, &#39;target&#39;, &#39;ChldNo_1&#39;, &#39;ChldNo_2More&#39;,
       &#39;gp_inc_high&#39;, &#39;gp_inc_medium&#39;, &#39;Age&#39;, &#39;gp_Age_high&#39;, &#39;gp_Age_highest&#39;,
       &#39;gp_Age_low&#39;, &#39;gp_Age_lowest&#39;, &#39;worktm&#39;, &#39;gp_worktm_high&#39;,
       &#39;gp_worktm_highest&#39;, &#39;gp_worktm_low&#39;, &#39;gp_worktm_medium&#39;, &#39;famsizegp_1&#39;,
       &#39;famsizegp_3more&#39;, &#39;occyp_hightecwk&#39;, &#39;occyp_officewk&#39;,
       &#39;houtp_Co-op apartment&#39;, &#39;houtp_Municipal apartment&#39;,
       &#39;houtp_Office apartment&#39;, &#39;houtp_Rented apartment&#39;,
       &#39;houtp_With parents&#39;, &#39;famtp_Civil marriage&#39;, &#39;famtp_Separated&#39;,
       &#39;famtp_Single / not married&#39;, &#39;famtp_Widow&#39;, &#39;edutp_Higher education&#39;,
       &#39;edutp_Incomplete higher&#39;, &#39;edutp_Lower secondary&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div id="ed57e6d127119c0c" class="cell code" data-execution_count="53"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:09.627641Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:09.608880Z&quot;}">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> new_data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> new_data[[<span class="st">&#39;Gender&#39;</span>,<span class="st">&#39;Realty&#39;</span>,<span class="st">&#39;ChldNo_1&#39;</span>, <span class="st">&#39;ChldNo_2More&#39;</span>,<span class="st">&#39;wkphone&#39;</span>,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;gp_Age_high&#39;</span>, <span class="st">&#39;gp_Age_highest&#39;</span>, <span class="st">&#39;gp_Age_low&#39;</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;gp_Age_lowest&#39;</span>,<span class="st">&#39;gp_worktm_high&#39;</span>, <span class="st">&#39;gp_worktm_highest&#39;</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;gp_worktm_low&#39;</span>, <span class="st">&#39;gp_worktm_medium&#39;</span>,<span class="st">&#39;occyp_hightecwk&#39;</span>, </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;occyp_officewk&#39;</span>,<span class="st">&#39;famsizegp_1&#39;</span>, <span class="st">&#39;famsizegp_3more&#39;</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;houtp_Co-op apartment&#39;</span>, <span class="st">&#39;houtp_Municipal apartment&#39;</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;houtp_Office apartment&#39;</span>, <span class="st">&#39;houtp_Rented apartment&#39;</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;houtp_With parents&#39;</span>,<span class="st">&#39;edutp_Higher education&#39;</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;edutp_Incomplete higher&#39;</span>, <span class="st">&#39;edutp_Lower secondary&#39;</span>,<span class="st">&#39;famtp_Civil marriage&#39;</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;famtp_Separated&#39;</span>,<span class="st">&#39;famtp_Single / not married&#39;</span>,<span class="st">&#39;famtp_Widow&#39;</span>]]</span></code></pre></div>
</div>
<div id="f2d16e2c" class="cell markdown">
<p>The <code>imbalanced-learn</code> library and the <code>SMOTE</code>
(Synthetic Minority Over-sampling Technique) module are commonly used in
machine learning to address the issue of class imbalance in
datasets.</p>
<p>Class imbalance occurs when one class (usually the minority class) is
significantly underrepresented compared to other classes in the dataset.
This can lead to biased models that perform poorly in predicting the
minority class.</p>
<p>SMOTE is a popular technique for addressing class imbalance by
generating synthetic samples of the minority class. It works by creating
new, synthetic instances of the minority class by interpolating between
existing minority class instances. This helps balance the class
distribution and improves the model's ability to learn from the minority
class.</p>
<p>Overall, <code>imbalanced-learn</code> and <code>SMOTE</code> are
used to improve the performance of machine learning models on imbalanced
datasets by addressing the issue of class imbalance through oversampling
techniques.</p>
</div>
<div id="32581a77c7c05a9a" class="cell code" data-execution_count="54"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:21.064826Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:18.441943Z&quot;}">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install imbalanced<span class="op">-</span>learn</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: imbalanced-learn in /Users/niiixxon/anaconda3/lib/python3.11/site-packages (0.12.2)
Requirement already satisfied: numpy&gt;=1.17.3 in /Users/niiixxon/anaconda3/lib/python3.11/site-packages (from imbalanced-learn) (1.26.4)
Requirement already satisfied: scipy&gt;=1.5.0 in /Users/niiixxon/anaconda3/lib/python3.11/site-packages (from imbalanced-learn) (1.13.0)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /Users/niiixxon/anaconda3/lib/python3.11/site-packages (from imbalanced-learn) (1.4.1.post1)
Requirement already satisfied: joblib&gt;=1.1.1 in /Users/niiixxon/anaconda3/lib/python3.11/site-packages (from imbalanced-learn) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /Users/niiixxon/anaconda3/lib/python3.11/site-packages (from imbalanced-learn) (3.4.0)
</code></pre>
</div>
</div>
<div id="de6f8c4b571691cd" class="cell code" data-execution_count="55"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:27:22.181333Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:27:22.019850Z&quot;}">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure your data and target variable are defined (X and Y)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> Y.astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply SMOTE to balance the classes</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>X_balance, Y_balance <span class="op">=</span> SMOTE().fit_resample(X, Y)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the balanced data back to a DataFrame if needed</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>X_balance <span class="op">=</span> pd.DataFrame(X_balance, columns<span class="op">=</span>X.columns)</span></code></pre></div>
</div>
<div id="2d0d778b97d77cc5" class="cell code" data-execution_count="56"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:29:15.586624Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:29:15.538847Z&quot;}">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure your target variable is of integer type</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> Y.astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the SMOTE object</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE()</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use fit_resample method instead of fit_sample</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>X_balance, Y_balance <span class="op">=</span> smote.fit_resample(X, Y)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the balanced data back to a DataFrame if needed</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>X_balance <span class="op">=</span> pd.DataFrame(X_balance, columns<span class="op">=</span>X.columns)</span></code></pre></div>
</div>
<div id="3357e92d21558925" class="cell markdown">
<p>AFTER OVER SAMPLING, THE NUMBER BETWEEN 1 AND 0 IS BALANCED. IT CAN
BE SEEN FROM THE CONFUSION MATRIX</p>
</div>
<div id="e4e55cc53e5ea9c1" class="cell code" data-execution_count="57"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:30:20.241186Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:30:20.223847Z&quot;}">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_balance,Y_balance, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                                                    stratify<span class="op">=</span>Y_balance, test_size<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                                                    random_state <span class="op">=</span> <span class="dv">10086</span>)</span></code></pre></div>
</div>
<div id="ae43cadaf93c2421" class="cell markdown">
<h2 id="logistic-regression">Logistic Regression</h2>
<p><span class="math display">$$\log ({p \over {1 - p}}) = {\beta _0} +
{\beta _1}{x_1} +  \cdot  \cdot  \cdot  + {\beta _q}{x_q}$$</span></p>
<p>This code trains a logistic regression model on the training data
(<code>X_train</code>, <code>y_train</code>), makes predictions on the
test data (<code>X_test</code>), and then prints the accuracy, F1 score,
precision, and recall scores of the model.</p>
<ul>
<li><p><strong>Accuracy Score</strong>: It measures the proportion of
correctly predicted instances among the total instances. An accuracy
score of 1.0 indicates perfect predictions.</p></li>
<li><p><strong>F1 Score</strong>: It is the harmonic mean of precision
and recall. It provides a balance between precision and recall. F1 score
is higher when both precision and recall are high.</p></li>
<li><p><strong>Precision Score</strong>: It measures the proportion of
true positive predictions among all positive predictions made by the
model. It is also known as the positive predictive value.</p></li>
<li><p><strong>Recall Score</strong>: It measures the proportion of true
positive predictions among all actual positive instances in the data. It
is also known as sensitivity or true positive rate.</p></li>
</ul>
<p>These metrics help evaluate the performance of the logistic
regression model in terms of its ability to correctly classify instances
into their respective classes.</p>
</div>
<div id="1ba52a145068cbd8" class="cell code" data-execution_count="58"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:30:54.838129Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:30:54.013227Z&quot;}">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> model.predict(X_test)</span></code></pre></div>
</div>
<div id="42e7eb931af6e8ca" class="cell code" data-execution_count="59"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:31:15.196236Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:31:15.179372Z&quot;}">
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy Score is </span><span class="sc">{:.3}</span><span class="st">&#39;</span>.<span class="bu">format</span>(accuracy_score(y_test, y_predict)))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;F1 Score is </span><span class="sc">{:.3}</span><span class="st">&#39;</span>.<span class="bu">format</span>(f1_score(y_test, y_predict)))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Precission Score is </span><span class="sc">{:.3}</span><span class="st">&#39;</span>.<span class="bu">format</span>(precision_score(y_test, y_predict)))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Recall Score is </span><span class="sc">{:.3}</span><span class="st">&#39;</span>.<span class="bu">format</span>(recall_score(y_test, y_predict)))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy Score is 0.668
F1 Score is 0.694
Precission Score is 0.645
Recall Score is 0.751
</code></pre>
</div>
</div>
<div id="105fe823" class="cell markdown">
<p>These scores indicate that the model's overall accuracy is moderate,
with a good balance between precision and recall. The F1 score suggests
that the model performs well in terms of both precision and recall,
indicating its effectiveness in correctly identifying positive instances
while minimizing false positives and false negatives.</p>
</div>
<div id="b6cf8e98b1860e" class="cell markdown">
<h3 id="tuning-hyperparameters">Tuning Hyperparameters</h3>
</div>
<div id="c1316d868d4aced0" class="cell markdown">
<p>In the context of Logistic Regression, C is the inverse of
regularization strength. Regularization is a technique used to prevent
overfitting by adding a penalty term to the loss function.</p>
<p>In Logistic Regression, regularization helps to control the
complexity of the model by penalizing large coefficients. A smaller C
value indicates stronger regularization, meaning the model will be more
restricted in terms of the coefficients it can learn. Conversely, a
larger C value means weaker regularization, allowing the model to fit
the training data more closely.</p>
</div>
<div id="bef99522b9f0d952" class="cell code" data-execution_count="60"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:37:29.678427Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:37:14.928111Z&quot;}">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>],  <span class="co"># Regularization parameter</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;penalty&#39;</span>: [<span class="st">&#39;l1&#39;</span>, <span class="st">&#39;l2&#39;</span>, <span class="st">&#39;l3&#39;</span>]                <span class="co"># Penalty type</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the GridSearchCV object</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(LogisticRegression(solver<span class="op">=</span><span class="st">&#39;liblinear&#39;</span>), param_grid, cv<span class="op">=</span><span class="dv">6</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform hyperparameter tuning</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the best hyperparameters</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> grid_search.best_params_</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model with the best hyperparameters</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>best_model <span class="op">=</span> LogisticRegression(solver<span class="op">=</span><span class="st">&#39;liblinear&#39;</span>, <span class="op">**</span>best_params)</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>best_model.fit(X_train, y_train)</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test data</span></span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> best_model.predict(X_test)</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate performance</span></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the evaluation metrics</span></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Best Parameters:&#39;</span>, best_params)</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy Score:&#39;</span>, accuracy)</span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;F1 Score:&#39;</span>, f1)</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Precision Score:&#39;</span>, precision)</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Recall Score:&#39;</span>, recall)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;C&#39;: 1, &#39;penalty&#39;: &#39;l1&#39;}
Accuracy Score: 0.668532506069598
F1 Score: 0.6939410922224298
Precision Score: 0.6445344129554655
Recall Score: 0.7515511195036417
</code></pre>
</div>
</div>
<div id="34f120ca" class="cell markdown">
<p>Comparing the performance of the optimized logistic regression model
with the previous results:</p>
<ul>
<li><strong>Accuracy Score</strong>: The accuracy remains relatively
unchanged, with a slight improvement from 0.668 to 0.669.</li>
<li><strong>F1 Score</strong>: The F1 score remains consistent,
indicating a similar balance between precision and recall.</li>
<li><strong>Precision Score</strong>: The precision score remains stable
at around 0.645, indicating the proportion of true positive predictions
among all positive predictions.</li>
<li><strong>Recall Score</strong>: The recall score shows a slight
improvement from 0.752 to 0.751, indicating the proportion of true
positive predictions among all actual positive instances.</li>
</ul>
<p>Overall, the optimized model shows consistent or slightly improved
performance across all metrics compared to the previous results.
However, the differences are relatively small, suggesting that the
optimization process did not lead to significant changes in model
performance.</p>
<hr />
</div>
<div id="8d780556" class="cell markdown">
<p>The following Python code conducts hyperparameter tuning for logistic
regression using GridSearchCV with F1 score as the scoring metric. It
searches for the optimal combination of regularization parameter
<code>C</code> and penalty type (<code>l1</code> for Lasso and
<code>l2</code> for Ridge) to maximize the F1 score on the training
data. After fitting the GridSearchCV object to the training data, it
prints out the best hyperparameters and the corresponding F1 score.</p>
</div>
<div id="e1f376eb3eaa8dc2" class="cell code" data-execution_count="61"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:36:31.037765Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:36:23.852085Z&quot;}">
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>grid<span class="op">=</span>{<span class="st">&quot;C&quot;</span>:np.logspace(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">7</span>), <span class="st">&quot;penalty&quot;</span>:[<span class="st">&quot;l1&quot;</span>,<span class="st">&quot;l2&quot;</span>]}<span class="co"># l1 lasso l2 ridge</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>logreg<span class="op">=</span>LogisticRegression(random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>logreg_cv<span class="op">=</span>GridSearchCV(logreg,grid,cv<span class="op">=</span><span class="dv">4</span>, scoring<span class="op">=</span><span class="st">&#39;f1&#39;</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>logreg_cv.fit(X_train,y_train)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;tuned hpyerparameters :(best parameters) &quot;</span>,logreg_cv.best_params_)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;accuracy :&quot;</span>,logreg_cv.best_score_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>tuned hpyerparameters :(best parameters)  {&#39;C&#39;: 10.0, &#39;penalty&#39;: &#39;l2&#39;}
accuracy : 0.6838594592583226
</code></pre>
</div>
</div>
<div id="06c06d21" class="cell markdown">
<p>The code snippet displays the best hyperparameters obtained through
hyperparameter tuning using GridSearchCV for logistic regression. It
identifies the optimal values for the regularization parameter
<code>C</code> and the penalty type (<code>l2</code> regularization).
Additionally, it prints out the corresponding accuracy achieved with
these best hyperparameters on the training data.</p>
<hr />
</div>
<div id="acd1e55b" class="cell markdown">
<p>This code snippet creates a logistic regression model with specific
hyperparameters (<code>C=0.1</code>, <code>penalty='l2'</code>) and then
trains it on the training data (<code>X_train</code>,
<code>y_train</code>). Finally, it predicts the target variable
(<code>y_predict</code>) using the trained model on the test data
(<code>X_test</code>).</p>
</div>
<div id="242a77eeabe1a02a" class="cell code" data-execution_count="62"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:40:32.611245Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:40:32.392851Z&quot;}">
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression(C<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                           random_state<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                           penalty<span class="op">=</span><span class="st">&#39;l2&#39;</span>) <span class="co"># Change penalty to &#39;l2&#39; or &#39;None&#39;</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> model.predict(X_test)</span></code></pre></div>
</div>
<div id="2a852a7600c2f9d6" class="cell code" data-execution_count="63"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:41:15.355806Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:41:15.274864Z&quot;}">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the confusion matrix as a DataFrame</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>conf_matrix_df <span class="op">=</span> pd.DataFrame(confusion_matrix(y_test, y_predict), index<span class="op">=</span>[<span class="st">&#39;Actual 0&#39;</span>, <span class="st">&#39;Actual 1&#39;</span>], columns<span class="op">=</span>[<span class="st">&#39;Predicted 0&#39;</span>, <span class="st">&#39;Predicted 1&#39;</span>])</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(conf_matrix_df)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the normalized confusion matrix</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&#39;white&#39;</span>) </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>class_names <span class="op">=</span> [<span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>]</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(confusion_matrix(y_test, y_predict),</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>                      classes<span class="op">=</span>class_names, normalize<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>                      title<span class="op">=</span><span class="st">&#39;Normalized Confusion Matrix: Logistic Regression&#39;</span>)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>          Predicted 0  Predicted 1
Actual 0         4349         3065
Actual 1         1948         5466
[[0.58659293 0.41340707]
 [0.26274616 0.73725384]]
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/cd21711509a1e1860a43c3b335dbbe476877b95b.svg" /></p>
</div>
</div>
<div id="ed2efe7a" class="cell markdown">
<p>The confusion matrix indicates the performance of a binary
classification model. In this case, the model predicted class 0
(negative) 4349 times correctly and 3065 times incorrectly, while it
predicted class 1 (positive) 5466 times correctly and 1948 times
incorrectly. The corresponding normalized confusion matrix shows that
the model achieved an accuracy of approximately 58.7% for class 0 and
73.7% for class 1.</p>
</div>
<div id="2e0d40e246297f3b" class="cell markdown">
<p><span class="math display">$$Accuracy = \frac{TP + TN}{TP + TN + FP +
FN}$$</span></p>
<p><span class="math display">$$ Recall  Sensitivity =  \frac{TP}{TP +
FN}$$</span></p>
<p><span class="math display">$$Precision  = \frac{TP}{TP +
FP}$$</span></p>
<p><span class="math display">$$F1 = 2 \cdot \frac{Precision \cdot
Recall}{Precision + Recall}$$</span></p>
</div>
<div id="99cfdecd02dd25c7" class="cell markdown">
<p>In terms of loans granted by the bank, precision and recall are
important metrics to evaluate the performance of a loan default
prediction model. Here's how they are defined:</p>
<p>Precision: Among the loans granted (according to the prediction),
what proportion of loans are actually repaid?</p>
<ul>
<li>Formula: Precision = True Positives / (True Positives + False
Positives)</li>
<li>Precision measures the quality of the model's positive predictions.
In the context of loans, high precision means that most loans granted by
the model are actually repaid. Low precision could indicate that the
bank is granting too many risky loans, which can lead to financial
losses.</li>
</ul>
<p>Recall: Among all the loans that should have been granted by the
bank, what proportion of loans are actually granted by the model?</p>
<ul>
<li><p>Formula: Recall = True Positives / (True Positives + False
Negatives)</p></li>
<li><p>Recall measures the model's ability to correctly identify loans
that should be granted. In the context of loans, high recall means that
most loans that should be granted are correctly identified by the model.
Low recall could indicate that the bank is missing out on many
profitable loan opportunities, which can affect its profits.</p></li>
<li><p>In summary, high precision indicates that the model correctly
predicts loan repayments, reducing the risk of loss for the bank. High
recall indicates that the model effectively identifies loans that should
be granted, which can contribute to the bank's profitability by
capturing more loan opportunities. However, there is often a trade-off
between precision and recall, and it's necessary to find a balance based
on the specific business objectives of the bank.</p></li>
</ul>
</div>
<div id="bc719345080f37e3" class="cell markdown">
<h2 id="decision-tree">Decision Tree</h2>
<p>The following code snippet trains a Decision Tree Classifier with
predefined hyperparameters and evaluates its performance on the test
set. It calculates the accuracy score and prints the confusion matrix,
which shows the counts of true negatives, false positives, false
negatives, and true positives. Additionally, it visualizes the
normalized confusion matrix to illustrate the model's performance for
each class.</p>
</div>
<div id="353c50d0f987794b" class="cell code" data-execution_count="64"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T01:18:24.175137Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T01:18:23.988997Z&quot;}">
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                               min_samples_split<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                               random_state<span class="op">=</span><span class="dv">1024</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> model.predict(X_test)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(accuracy_score(y_test, y_predict)))</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(confusion_matrix(y_test,y_predict)))</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(confusion_matrix(y_test,y_predict),</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>                      classes<span class="op">=</span>class_names, normalize <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>                      title<span class="op">=</span><span class="st">&#39;Normalized Confusion Matrix: CART&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy Score is 0.77414
      0     1
0  4390  3024
1   325  7089
[[0.59212301 0.40787699]
 [0.04383599 0.95616401]]
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/58fd0e278964b4f80f7a87ea692a6e36113fb0e0.svg" /></p>
</div>
</div>
<div id="b8d78e38" class="cell markdown">
<p>The accuracy score of the Decision Tree Classifier model is
approximately 0.77414. The confusion matrix is presented as a DataFrame,
showing the counts of true negatives, false positives, false negatives,
and true positives. Additionally, the normalized confusion matrix
visualizes the model's performance for each class, with class 0 having a
true negative rate of approximately 0.592 and class 1 having a true
positive rate of approximately 0.956.</p>
</div>
<div id="2435059731cf6270" class="cell code" data-execution_count="65"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T01:18:24.193323Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T01:18:24.175869Z&quot;}">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(accuracy_score(y_test, y_predict)))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;F1 Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(f1_score(y_test, y_predict)))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Precission Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(precision_score(y_test, y_predict)))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Recall Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(recall_score(y_test, y_predict)))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy Score is 0.77414
F1 Score is 0.80892
Precission Score is 0.70098
Recall Score is 0.95616
</code></pre>
</div>
</div>
<div id="c896dd3d" class="cell markdown">
<p>Based on the provided evaluation metrics:</p>
<ol>
<li><p><strong>Accuracy Score:</strong> The model achieved an accuracy
of around 77.41%, indicating that it correctly classified roughly 77.41%
of the samples in the test set.</p></li>
<li><p><strong>F1 Score:</strong> The F1 score, which is the harmonic
mean of precision and recall, is approximately 80.89%. This suggests a
good balance between precision and recall.</p></li>
<li><p><strong>Precision Score:</strong> The precision score is
approximately 70.10%, indicating that when the model predicts a positive
class, it is correct about 70.10% of the time.</p></li>
<li><p><strong>Recall Score:</strong> The recall score is notably high
at around 95.62%, indicating that the model can successfully identify
about 95.62% of all actual positive samples.</p></li>
</ol>
<p>These results suggest that the model performs reasonably well in
terms of overall accuracy and particularly excels in recall, indicating
its effectiveness in identifying positive cases. However, precision
could be improved, suggesting a potential for reducing false positives.
Overall, the model seems to perform well but could benefit from further
optimization or fine-tuning to improve precision without sacrificing
recall.</p>
<hr />
</div>
<div id="8a612ff9c790af32" class="cell markdown">
<h2 id="random-forest">Random Forest</h2>
<p>The code snippet trains a Random Forest classifier with specific
hyperparameters (n_estimators=250, max_depth=12, min_samples_leaf=16)
using the training data (X_train, y_train). Then, it predicts the target
variable using the test data (X_test) and evaluates the model's
performance using accuracy score. Additionally, it prints a confusion
matrix to display the number of true positive, false positive, true
negative, and false negative predictions, and visualizes the normalized
confusion matrix using a function called plot_confusion_matrix. This
allows for a better understanding of the model's performance in terms of
correctly and incorrectly classified instances.</p>
</div>
<div id="515a967cbd941742" class="cell code" data-execution_count="66"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:46:31.506294Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:46:28.814457Z&quot;}">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">250</span>,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                              max_depth<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                              min_samples_leaf<span class="op">=</span><span class="dv">16</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> model.predict(X_test)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(accuracy_score(y_test, y_predict)))</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(confusion_matrix(y_test,y_predict)))</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(confusion_matrix(y_test,y_predict),</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>                      classes<span class="op">=</span>class_names, normalize <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>                      title<span class="op">=</span><span class="st">&#39;Normalized Confusion Matrix: Ramdom Forests&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy Score is 0.79013
      0     1
0  5161  2253
1   859  6555
[[0.69611546 0.30388454]
 [0.11586188 0.88413812]]
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/1e6aabaf8cfc5dbe18e737ba1e32a412ab1dd901.svg" /></p>
</div>
</div>
<div id="1279966e" class="cell markdown">
<p>The Random Forest classifier achieved an accuracy score of
approximately 0.79013 on the test data. The confusion matrix shows that
out of all instances where the actual label was 0, the model correctly
predicted around 69.61% (5161) and incorrectly predicted around 30.39%
(2253) as 1. Similarly, out of all instances where the actual label was
1, the model correctly predicted around 88.41% (6555) and incorrectly
predicted around 11.59% (859) as 0. Overall, the model performed
reasonably well in terms of accuracy and correctly classified a
significant portion of both classes.</p>
</div>
<div id="1a17f05000a7dd46" class="cell code" data-execution_count="67"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T00:46:43.487577Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:46:43.465490Z&quot;}">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(accuracy_score(y_test, y_predict)))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;F1 Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(f1_score(y_test, y_predict)))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Precission Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(precision_score(y_test, y_predict)))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Recall Score is </span><span class="sc">{:.5}</span><span class="st">&#39;</span>.<span class="bu">format</span>(recall_score(y_test, y_predict)))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy Score is 0.79013
F1 Score is 0.80816
Precission Score is 0.74421
Recall Score is 0.88414
</code></pre>
</div>
</div>
<div id="bf46ef14" class="cell markdown">
<p>The Random Forest classifier achieved an accuracy score of
approximately 0.79013 on the test data. Additionally, it attained an F1
score of approximately 0.80816, precision score of about 0.74421, and
recall score of around 0.88414. These scores indicate that the model
performed well overall, with a balanced performance in terms of
precision and recall, capturing a high proportion of true positives
while minimizing false positives.</p>
</div>
<div id="8a7897db5c687ee4" class="cell code"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T01:12:16.124812Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T00:47:25.964175Z&quot;}">
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the grid of hyperparameters for the SVM model</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">#param_grid = {&#39;C&#39;: [0.1, 1, 10], &#39;kernel&#39;: [&#39;linear&#39;, &#39;rbf&#39;], &#39;gamma&#39;: [0.1, 1, 10]}</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the SVM model and the grid search</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#svm = SVC()</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#grid_search = GridSearchCV(svm, param_grid, cv=4, scoring=&#39;f1&#39;)</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform grid search on the training set</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#grid_search.fit(X_train, y_train)</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the best hyperparameters and the corresponding F1 score on the training set</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&quot;Best hyperparameters: &quot;, grid_search.best_params_)</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&quot;F1 score on training set: &quot;, grid_search.best_score_)</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the optimized model to make predictions on the test set</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co">#y_pred = grid_search.predict(X_test)</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model&#39;s performance on the test set</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co">#accuracy = accuracy_score(y_test, y_pred)</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co">#f1 = f1_score(y_test, y_pred)</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&quot;Accuracy on test set: &quot;, accuracy)</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&quot;F1 score on test set: &quot;, f1)</span></span></code></pre></div>
</div>
<div id="68978426" class="cell markdown">
<h2 id="k-nearest-neighbour">K Nearest Neighbour</h2>
<p>This code performs hyperparameter tuning for a k-Nearest Neighbors
(k-NN) classifier using grid search with cross-validation. It defines a
grid of hyperparameters including the number of neighbors, the weighting
method, and the distance metric. Then, it uses GridSearchCV to find the
combination of hyperparameters that maximizes the F1 score on the
training set. After obtaining the best hyperparameters, it evaluates the
model's performance on the test set by calculating accuracy and F1
score. Finally, it prints the confusion matrix to visualize the model's
predictions compared to the actual labels in the test set.</p>
</div>
<div id="a5b8ea67038c465f" class="cell code" data-execution_count="68"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T01:13:49.760460Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T01:13:27.226452Z&quot;}">
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, f1_score, confusion_matrix</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the grid of hyperparameters for the k-NN model</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">&#39;n_neighbors&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>], <span class="st">&#39;weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>, <span class="st">&#39;distance&#39;</span>], <span class="st">&#39;p&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>]}</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the k-NN model and the grid search</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(knn, param_grid, cv<span class="op">=</span><span class="dv">4</span>, scoring<span class="op">=</span><span class="st">&#39;f1&#39;</span>)</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform grid search on the training set</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the best hyperparameters and the corresponding F1 score on the training set</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best hyperparameters: &quot;</span>, grid_search.best_params_)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1 score on training set: &quot;</span>, grid_search.best_score_)</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the optimized model to make predictions on the test set</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> grid_search.predict(X_test)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model&#39;s performance on the test set</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy on test set: &quot;</span>, accuracy)</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1 score on test set: &quot;</span>, f1)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Print confusion matrix</span></span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best hyperparameters:  {&#39;n_neighbors&#39;: 5, &#39;p&#39;: 1, &#39;weights&#39;: &#39;distance&#39;}
F1 score on training set:  0.8612600474820452
Accuracy on test set:  0.8527785271108713
F1 score on test set:  0.8620537124802528
Confusion Matrix:
[[5824 1590]
 [ 593 6821]]
</code></pre>
</div>
</div>
<div id="d270a094" class="cell markdown">
<p>The grid search identified the best hyperparameters for the k-NN
classifier as having 5 neighbors, using a Manhattan distance metric
(p=1), and employing distance-based weights. On the training set, the F1
score achieved with these parameters is approximately 0.8613. When
applied to the test set, the model achieved an accuracy of around 0.8528
and an F1 score of approximately 0.8621. The confusion matrix shows the
distribution of actual and predicted labels, indicating that the model
performs reasonably well in classifying both positive and negative
instances.</p>
</div>
<div id="5f0336362d3ff462" class="cell code" data-execution_count="69"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T01:15:42.643216Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T01:15:27.569174Z&quot;}">
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of values for the number of neighbors</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>neighbors_range <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">31</span>)  <span class="co"># Change this range as needed</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Lists to store performance metrics</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>accuracies <span class="op">=</span> []</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>f1_scores <span class="op">=</span> []</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over different values of n_neighbors</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> neighbors_range:</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>n)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    knn.fit(X_train, y_train)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    accuracies.append(accuracy)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    f1_scores.append(f1)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot accuracy and F1 score versus number of neighbors</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>plt.plot(neighbors_range, accuracies, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, label<span class="op">=</span><span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>plt.plot(neighbors_range, f1_scores, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, label<span class="op">=</span><span class="st">&#39;F1 Score&#39;</span>)</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Performance of k-NN with Different Number of Neighbors&#39;</span>)</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Number of Neighbors&#39;</span>)</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Metric Value&#39;</span>)</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>plt.xticks(neighbors_range)</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/63d55b26ec531f3098681f75fcd88a7b42694bf4.svg" /></p>
</div>
</div>
<div id="a24c912d" class="cell markdown">
<h2 id="evaluating-each-model">Evaluating each model</h2>
<p>This code defines and evaluates multiple machine learning models,
including Logistic Regression, Decision Tree, Random Forest, and
k-Nearest Neighbors (k-NN), using the provided dataset. It trains each
model on the training data (<code>X_train</code>, <code>y_train</code>)
and evaluates its performance on the test data (<code>X_test</code>,
<code>y_test</code>). For each model, it calculates and prints several
evaluation metrics such as accuracy, F1 score, precision, recall, and
the confusion matrix. Additionally, it plots the confusion matrices for
each model using seaborn's heatmap function. This allows for a
comprehensive comparison of the models' performances.</p>
</div>
<div id="975435cb01cd12c6" class="cell code" data-execution_count="72"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2024-04-05T01:20:58.633690Z&quot;,&quot;start_time&quot;:&quot;2024-04-05T01:20:54.459340Z&quot;}">
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, f1_score, precision_score, recall_score, confusion_matrix</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define models</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Logistic Regression&#39;</span>: LogisticRegression(),</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Decision Tree&#39;</span>: DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">12</span>, min_samples_split<span class="op">=</span><span class="dv">8</span>, random_state<span class="op">=</span><span class="dv">1024</span>),</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Random Forest&#39;</span>: RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">250</span>, max_depth<span class="op">=</span><span class="dv">12</span>, min_samples_leaf<span class="op">=</span><span class="dv">16</span>),</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;k-NN&#39;</span>: KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)  <span class="co"># Use the best hyperparameters found</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate each model</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> {}</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>    confusion <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>    results[name] <span class="op">=</span> {<span class="st">&#39;Accuracy&#39;</span>: accuracy, <span class="st">&#39;F1 Score&#39;</span>: f1, <span class="st">&#39;Precision&#39;</span>: precision, <span class="st">&#39;Recall&#39;</span>: recall, <span class="st">&#39;Confusion Matrix&#39;</span>: confusion}</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, metrics <span class="kw">in</span> results.items():</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:&#39;</span>)</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metric, value <span class="kw">in</span> metrics.items():</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrices</span></span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (name, metrics) <span class="kw">in</span> <span class="bu">enumerate</span>(results.items(), <span class="dv">1</span>):</span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, i)</span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(metrics[<span class="st">&#39;Confusion Matrix&#39;</span>], annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, xticklabels<span class="op">=</span>[<span class="st">&#39;Predicted 0&#39;</span>, <span class="st">&#39;Predicted 1&#39;</span>], yticklabels<span class="op">=</span>[<span class="st">&#39;Actual 0&#39;</span>, <span class="st">&#39;Actual 1&#39;</span>])</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Confusion Matrix: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Logistic Regression:
Accuracy: 0.6684650660911788
F1 Score: 0.6937834807524604
Precision: 0.6445601851851852
Recall: 0.7511464796331265
Confusion Matrix: [[4343 3071]
 [1845 5569]]

Decision Tree:
Accuracy: 0.7741435122740761
F1 Score: 0.8089233753637245
Precision: 0.7009789380005933
Recall: 0.9561640140275155
Confusion Matrix: [[4390 3024]
 [ 325 7089]]

Random Forest:
Accuracy: 0.7922174264904235
F1 Score: 0.8100844480059175
Precision: 0.7459416505846294
Recall: 0.8862961963852172
Confusion Matrix: [[5176 2238]
 [ 843 6571]]

k-NN:
Accuracy: 0.8463042891826275
F1 Score: 0.8566756807747941
Precision: 0.8025215034759043
Recall: 0.9186673860264365
Confusion Matrix: [[5738 1676]
 [ 603 6811]]

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_1b016e66736149dc8717d434d11da9d2/032675298f2227422a198011a6897199fc32a45a.svg" /></p>
</div>
</div>
<div id="5cd531d3" class="cell markdown">
<p>Throughout this project, we've explored various aspects of machine
learning model evaluation using a dataset. Here's a summary of what
we've done and my views on the evaluation:</p>
<ol>
<li><p><strong>Data Preprocessing</strong>: We started by preprocessing
the dataset, which involved handling missing values, encoding
categorical variables, and splitting the data into training and testing
sets.</p></li>
<li><p><strong>Model Training and Evaluation</strong>:</p>
<ul>
<li><strong>Logistic Regression</strong>: We trained a logistic
regression model and evaluated its performance using accuracy, F1 score,
precision, recall, and the confusion matrix.</li>
<li><strong>Decision Tree</strong>: Another model we trained was the
decision tree classifier. We tuned its hyperparameters and evaluated its
performance.</li>
<li><strong>Random Forest</strong>: We also explored the random forest
classifier, adjusting its parameters for optimal performance and
evaluating it.</li>
<li><strong>k-Nearest Neighbors (k-NN)</strong>: Lastly, we used the
k-NN algorithm, determining the best number of neighbors and evaluating
its performance.</li>
</ul></li>
<li><p><strong>Comparative Analysis</strong>: We compared the
performance of all models based on various evaluation metrics and
visualized their confusion matrices to gain insights into their
strengths and weaknesses.</p></li>
</ol>
<p><strong>My Views on Evaluation</strong>:</p>
<ul>
<li>Each model has its strengths and weaknesses, and the ideal choice
depends on the specific requirements of the task.</li>
<li>Logistic regression is a simple yet effective model, suitable for
binary classification tasks.</li>
<li>Decision trees are easy to interpret and can capture complex
relationships in the data, but they may overfit.</li>
<li>Random forests, being an ensemble of decision trees, often provide
better generalization and robustness to overfitting.</li>
<li>k-Nearest Neighbors is a simple and intuitive algorithm, but it may
not perform well with high-dimensional data or imbalanced datasets.</li>
</ul>
<p><strong>Ideal Model Recommendation:</strong></p>
<p>Considering the complexity of our dataset and the need for robust
performance, the ideal model for this application would be the Random
Forest. It strikes a balance between complexity and generalization,
making it well-suited for our classification task. Additionally, its
ensemble nature helps mitigate overfitting and captures intricate
patterns in the data, making it a strong contender for our modeling
needs. Therefore, I recommend proceeding with the Random Forest model
for this application.</p>
<p>In conclusion, it's essential to consider various factors such as
interpretability, performance metrics, computational resources, and
domain knowledge when selecting the ideal model for a particular task.
Experimentation and thorough evaluation are key to making an informed
decision.</p>
</div>
</body>
</html>
